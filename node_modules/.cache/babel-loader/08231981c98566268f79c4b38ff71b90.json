{"ast":null,"code":"import _asyncToGenerator from \"C:/PartTimeJob/blog/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"C:/PartTimeJob/blog/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport \"regenerator-runtime/runtime.js\";\nimport \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/es.string.starts-with.js\";\nimport \"core-js/modules/es.array.join.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport { ref, watchEffect, watch, unref, computed, onMounted, nextTick, onBeforeUnmount } from 'vue';\nimport '../../../../utils/index.mjs';\nimport '../../../../hooks/index.mjs';\nimport { parseHeight } from '../util.mjs';\nimport { addResizeListener, removeResizeListener } from '../../../../utils/dom/resize-event.mjs';\nimport { on, off } from '../../../../utils/dom/event.mjs';\nimport { useSize } from '../../../../hooks/use-common-props/index.mjs';\nimport { isString } from '@vue/shared';\nimport { isNumber } from '@vueuse/core';\n\nfunction useStyle(props, layout, store, table) {\n  var isHidden = ref(false);\n  var renderExpanded = ref(null);\n  var resizeProxyVisible = ref(false);\n\n  var setDragVisible = function setDragVisible(visible) {\n    resizeProxyVisible.value = visible;\n  };\n\n  var resizeState = ref({\n    width: null,\n    height: null\n  });\n  var isGroup = ref(false);\n  var scrollbarViewStyle = {\n    display: \"inline-block\",\n    verticalAlign: \"middle\"\n  };\n  var tableWidth = ref();\n  watchEffect(function () {\n    layout.setHeight(props.height);\n  });\n  watchEffect(function () {\n    layout.setMaxHeight(props.maxHeight);\n  });\n  watch(function () {\n    return [props.currentRowKey, store.states.rowKey];\n  }, function (_ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n        currentRowKey = _ref2[0],\n        rowKey = _ref2[1];\n\n    if (!unref(rowKey)) return;\n    store.setCurrentRowKey(\"\".concat(currentRowKey));\n  }, {\n    immediate: true\n  });\n  watch(function () {\n    return props.data;\n  }, function (data) {\n    table.store.commit(\"setData\", data);\n  }, {\n    immediate: true,\n    deep: true\n  });\n  watchEffect(function () {\n    if (props.expandRowKeys) {\n      store.setExpandRowKeysAdapter(props.expandRowKeys);\n    }\n  });\n\n  var handleMouseLeave = function handleMouseLeave() {\n    table.store.commit(\"setHoverRow\", null);\n    if (table.hoverState) table.hoverState = null;\n  };\n\n  var handleHeaderFooterMousewheel = function handleHeaderFooterMousewheel(event, data) {\n    var pixelX = data.pixelX,\n        pixelY = data.pixelY;\n\n    if (Math.abs(pixelX) >= Math.abs(pixelY)) {\n      table.refs.bodyWrapper.scrollLeft += data.pixelX / 5;\n    }\n  };\n\n  var shouldUpdateHeight = computed(function () {\n    return props.height || props.maxHeight || store.states.fixedColumns.value.length > 0 || store.states.rightFixedColumns.value.length > 0;\n  });\n  var tableBodyStyles = computed(function () {\n    return {\n      width: layout.bodyWidth.value ? \"\".concat(layout.bodyWidth.value, \"px\") : \"\"\n    };\n  });\n\n  var doLayout = function doLayout() {\n    if (shouldUpdateHeight.value) {\n      layout.updateElsHeight();\n    }\n\n    layout.updateColumnsWidth();\n    requestAnimationFrame(syncPostion);\n  };\n\n  onMounted( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return nextTick();\n\n          case 2:\n            store.updateColumns();\n            bindEvents();\n            requestAnimationFrame(doLayout);\n            resizeState.value = {\n              width: tableWidth.value = table.vnode.el.offsetWidth,\n              height: table.vnode.el.offsetHeight\n            };\n            store.states.columns.value.forEach(function (column) {\n              if (column.filteredValue && column.filteredValue.length) {\n                table.store.commit(\"filterChange\", {\n                  column: column,\n                  values: column.filteredValue,\n                  silent: true\n                });\n              }\n            });\n            table.$ready = true;\n\n          case 8:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  })));\n\n  var setScrollClassByEl = function setScrollClassByEl(el, className) {\n    if (!el) return;\n    var classList = Array.from(el.classList).filter(function (item) {\n      return !item.startsWith(\"is-scrolling-\");\n    });\n    classList.push(layout.scrollX.value ? className : \"is-scrolling-none\");\n    el.className = classList.join(\" \");\n  };\n\n  var setScrollClass = function setScrollClass(className) {\n    var tableWrapper = table.refs.tableWrapper;\n    setScrollClassByEl(tableWrapper, className);\n  };\n\n  var hasScrollClass = function hasScrollClass(className) {\n    var tableWrapper = table.refs.tableWrapper;\n\n    if (tableWrapper && tableWrapper.classList.contains(className)) {\n      return true;\n    }\n\n    return false;\n  };\n\n  var syncPostion = function syncPostion() {\n    if (!table.refs.scrollBarRef) return;\n\n    if (!layout.scrollX.value) {\n      var scrollingNoneClass = \"is-scrolling-none\";\n\n      if (!hasScrollClass(scrollingNoneClass)) {\n        setScrollClass(scrollingNoneClass);\n      }\n\n      return;\n    }\n\n    var scrollContainer = table.refs.scrollBarRef.wrap$;\n    if (!scrollContainer) return;\n    var scrollLeft = scrollContainer.scrollLeft,\n        offsetWidth = scrollContainer.offsetWidth,\n        scrollWidth = scrollContainer.scrollWidth;\n    var _table$refs = table.refs,\n        headerWrapper = _table$refs.headerWrapper,\n        footerWrapper = _table$refs.footerWrapper;\n    if (headerWrapper) headerWrapper.scrollLeft = scrollLeft;\n    if (footerWrapper) footerWrapper.scrollLeft = scrollLeft;\n    var maxScrollLeftPosition = scrollWidth - offsetWidth - 1;\n\n    if (scrollLeft >= maxScrollLeftPosition) {\n      setScrollClass(\"is-scrolling-right\");\n    } else if (scrollLeft === 0) {\n      setScrollClass(\"is-scrolling-left\");\n    } else {\n      setScrollClass(\"is-scrolling-middle\");\n    }\n  };\n\n  var bindEvents = function bindEvents() {\n    var _a;\n\n    if (!table.refs.scrollBarRef) return;\n    (_a = table.refs.scrollBarRef.wrap$) == null ? void 0 : _a.addEventListener(\"scroll\", syncPostion, {\n      passive: true\n    });\n\n    if (props.fit) {\n      addResizeListener(table.vnode.el, resizeListener);\n    } else {\n      on(window, \"resize\", doLayout);\n    }\n  };\n\n  onBeforeUnmount(function () {\n    unbindEvents();\n  });\n\n  var unbindEvents = function unbindEvents() {\n    var _a;\n\n    (_a = table.refs.scrollBarRef.wrap$) == null ? void 0 : _a.removeEventListener(\"scroll\", syncPostion, true);\n\n    if (props.fit) {\n      removeResizeListener(table.vnode.el, resizeListener);\n    } else {\n      off(window, \"resize\", doLayout);\n    }\n  };\n\n  var resizeListener = function resizeListener() {\n    if (!table.$ready) return;\n    var shouldUpdateLayout = false;\n    var el = table.vnode.el;\n    var _resizeState$value = resizeState.value,\n        oldWidth = _resizeState$value.width,\n        oldHeight = _resizeState$value.height;\n    var width = tableWidth.value = el.offsetWidth;\n\n    if (oldWidth !== width) {\n      shouldUpdateLayout = true;\n    }\n\n    var height2 = el.offsetHeight;\n\n    if ((props.height || shouldUpdateHeight.value) && oldHeight !== height2) {\n      shouldUpdateLayout = true;\n    }\n\n    if (shouldUpdateLayout) {\n      resizeState.value = {\n        width: width,\n        height: height2\n      };\n      doLayout();\n    }\n  };\n\n  var tableSize = useSize();\n  var bodyWidth = computed(function () {\n    var bodyWidth_ = layout.bodyWidth,\n        scrollY = layout.scrollY,\n        gutterWidth = layout.gutterWidth;\n    return bodyWidth_.value ? \"\".concat(bodyWidth_.value - (scrollY.value ? gutterWidth : 0), \"px\") : \"\";\n  });\n  var tableLayout = computed(function () {\n    if (props.maxHeight) return \"fixed\";\n    return props.tableLayout;\n  });\n\n  function calcMaxHeight(maxHeight, footerHeight, headerHeight) {\n    var parsedMaxHeight = parseHeight(maxHeight);\n    var tableHeaderHeight = props.showHeader ? headerHeight : 0;\n    if (parsedMaxHeight === null) return;\n\n    if (isString(parsedMaxHeight)) {\n      return \"calc(\".concat(parsedMaxHeight, \" - \").concat(footerHeight, \"px - \").concat(tableHeaderHeight, \"px)\");\n    }\n\n    return parsedMaxHeight - footerHeight - tableHeaderHeight;\n  }\n\n  var height = computed(function () {\n    var headerHeight = layout.headerHeight.value || 0;\n    var bodyHeight2 = layout.bodyHeight.value;\n    var footerHeight = layout.footerHeight.value || 0;\n\n    if (props.height) {\n      return bodyHeight2 ? bodyHeight2 : void 0;\n    } else if (props.maxHeight) {\n      return calcMaxHeight(props.maxHeight, footerHeight, headerHeight);\n    }\n\n    return void 0;\n  });\n  var bodyHeight = computed(function () {\n    var headerHeight = layout.headerHeight.value || 0;\n    var bodyHeight2 = layout.bodyHeight.value;\n    var footerHeight = layout.footerHeight.value || 0;\n\n    if (props.height) {\n      return {\n        height: bodyHeight2 ? \"\".concat(bodyHeight2, \"px\") : \"\"\n      };\n    } else if (props.maxHeight) {\n      var maxHeight = calcMaxHeight(props.maxHeight, footerHeight, headerHeight);\n\n      if (maxHeight !== null) {\n        return {\n          \"max-height\": \"\".concat(maxHeight).concat(isNumber(maxHeight) ? \"px\" : \"\")\n        };\n      }\n    }\n\n    return {};\n  });\n  var emptyBlockStyle = computed(function () {\n    if (props.data && props.data.length) return null;\n    var height2 = \"100%\";\n\n    if (layout.appendHeight.value) {\n      height2 = \"calc(100% - \".concat(layout.appendHeight.value, \"px)\");\n    }\n\n    return {\n      width: tableWidth.value ? \"\".concat(tableWidth.value, \"px\") : \"\",\n      height: height2\n    };\n  });\n\n  var handleFixedMousewheel = function handleFixedMousewheel(event, data) {\n    var bodyWrapper = table.refs.bodyWrapper;\n\n    if (Math.abs(data.spinY) > 0) {\n      var currentScrollTop = bodyWrapper.scrollTop;\n\n      if (data.pixelY < 0 && currentScrollTop !== 0) {\n        event.preventDefault();\n      }\n\n      if (data.pixelY > 0 && bodyWrapper.scrollHeight - bodyWrapper.clientHeight > currentScrollTop) {\n        event.preventDefault();\n      }\n\n      bodyWrapper.scrollTop += Math.ceil(data.pixelY / 5);\n    } else {\n      bodyWrapper.scrollLeft += Math.ceil(data.pixelX / 5);\n    }\n  };\n\n  var fixedHeight = computed(function () {\n    if (props.maxHeight) {\n      if (props.showSummary) {\n        return {\n          bottom: 0\n        };\n      }\n\n      return {\n        bottom: layout.scrollX.value && props.data.length ? \"\".concat(layout.gutterWidth, \"px\") : \"\"\n      };\n    } else {\n      if (props.showSummary) {\n        return {\n          height: layout.tableHeight.value ? \"\".concat(layout.tableHeight.value, \"px\") : \"\"\n        };\n      }\n\n      return {\n        height: layout.viewportHeight.value ? \"\".concat(layout.viewportHeight.value, \"px\") : \"\"\n      };\n    }\n  });\n  var fixedBodyHeight = computed(function () {\n    if (props.height) {\n      return {\n        height: layout.fixedBodyHeight.value ? \"\".concat(layout.fixedBodyHeight.value, \"px\") : \"\"\n      };\n    } else if (props.maxHeight) {\n      var maxHeight = parseHeight(props.maxHeight);\n\n      if (typeof maxHeight === \"number\") {\n        maxHeight = layout.scrollX.value ? maxHeight - layout.gutterWidth : maxHeight;\n\n        if (props.showHeader) {\n          maxHeight -= layout.headerHeight.value;\n        }\n\n        maxHeight -= layout.footerHeight.value;\n        return {\n          \"max-height\": \"\".concat(maxHeight, \"px\")\n        };\n      }\n    }\n\n    return {};\n  });\n  return {\n    isHidden: isHidden,\n    renderExpanded: renderExpanded,\n    setDragVisible: setDragVisible,\n    isGroup: isGroup,\n    handleMouseLeave: handleMouseLeave,\n    handleHeaderFooterMousewheel: handleHeaderFooterMousewheel,\n    tableSize: tableSize,\n    bodyHeight: bodyHeight,\n    height: height,\n    emptyBlockStyle: emptyBlockStyle,\n    handleFixedMousewheel: handleFixedMousewheel,\n    fixedHeight: fixedHeight,\n    fixedBodyHeight: fixedBodyHeight,\n    resizeProxyVisible: resizeProxyVisible,\n    bodyWidth: bodyWidth,\n    resizeState: resizeState,\n    doLayout: doLayout,\n    tableBodyStyles: tableBodyStyles,\n    tableLayout: tableLayout,\n    scrollbarViewStyle: scrollbarViewStyle\n  };\n}\n\nexport { useStyle as default };","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;AAoBA,SAASA,QAAT,CAAkBC,KAAlB,EAAyBC,MAAzB,EAAiCC,KAAjC,EAAwCC,KAAxC,EAA+C;AAC7C,MAAMC,QAAQ,GAAGC,GAAG,CAAC,KAAD,CAApB;AACA,MAAMC,cAAc,GAAGD,GAAG,CAAC,IAAD,CAA1B;AACA,MAAME,kBAAkB,GAAGF,GAAG,CAAC,KAAD,CAA9B;;AACA,MAAMG,cAAc,GAAG,SAAjBA,cAAiB,CAACC,OAAD,EAAa;AAClCF,sBAAkB,CAACG,KAAnB,GAA2BD,OAA3B;AACD,GAFD;;AAGA,MAAME,WAAW,GAAGN,GAAG,CAAC;AACtBO,SAAK,EAAE,IADe;AAEtBC,UAAM,EAAE;AAFc,GAAD,CAAvB;AAIA,MAAMC,OAAO,GAAGT,GAAG,CAAC,KAAD,CAAnB;AACA,MAAMU,kBAAkB,GAAG;AACzBC,WAAO,EAAE,cADgB;AAEzBC,iBAAa,EAAE;AAFU,GAA3B;AAIA,MAAMC,UAAU,GAAGb,GAAG,EAAtB;AACAc,aAAW,CAAC,YAAM;AAChBlB,UAAM,CAACmB,SAAP,CAAiBpB,KAAK,CAACa,MAAvB;AACD,GAFU,CAAX;AAGAM,aAAW,CAAC,YAAM;AAChBlB,UAAM,CAACoB,YAAP,CAAoBrB,KAAK,CAACsB,SAA1B;AACD,GAFU,CAAX;AAGAC,OAAK,CAAC;AAAA,WAAM,CAACvB,KAAK,CAACwB,aAAP,EAAsBtB,KAAK,CAACuB,MAAN,CAAaC,MAAnC,CAAN;AAAA,GAAD,EAAmD,gBAA6B;AAAA;AAAA,QAA3BF,aAA2B;AAAA,QAAZE,MAAY;;AACnF,QAAI,CAACC,KAAK,CAACD,MAAD,CAAV,EACE;AACFxB,SAAK,CAAC0B,gBAAN,WAA0BJ,aAA1B;AACD,GAJI,EAIF;AACDK,aAAS,EAAE;AADV,GAJE,CAAL;AAOAN,OAAK,CAAC;AAAA,WAAMvB,KAAK,CAAC8B,IAAZ;AAAA,GAAD,EAAmB,UAACA,IAAD,EAAU;AAChC3B,SAAK,CAACD,KAAN,CAAY6B,MAAZ,CAAmB,SAAnB,EAA8BD,IAA9B;AACD,GAFI,EAEF;AACDD,aAAS,EAAE,IADV;AAEDG,QAAI,EAAE;AAFL,GAFE,CAAL;AAMAb,aAAW,CAAC,YAAM;AAChB,QAAInB,KAAK,CAACiC,aAAV,EAAyB;AACvB/B,WAAK,CAACgC,uBAAN,CAA8BlC,KAAK,CAACiC,aAApC;AACD;AACF,GAJU,CAAX;;AAKA,MAAME,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAM;AAC7BhC,SAAK,CAACD,KAAN,CAAY6B,MAAZ,CAAmB,aAAnB,EAAkC,IAAlC;AACA,QAAI5B,KAAK,CAACiC,UAAV,EACEjC,KAAK,CAACiC,UAAN,GAAmB,IAAnB;AACH,GAJD;;AAKA,MAAMC,4BAA4B,GAAG,SAA/BA,4BAA+B,CAACC,KAAD,EAAQR,IAAR,EAAiB;AACpD,QAAQS,MAAR,GAA2BT,IAA3B,CAAQS,MAAR;AAAA,QAAgBC,MAAhB,GAA2BV,IAA3B,CAAgBU,MAAhB;;AACA,QAAIC,IAAI,CAACC,GAAL,CAASH,MAAT,KAAoBE,IAAI,CAACC,GAAL,CAASF,MAAT,CAAxB,EAA0C;AACxCrC,WAAK,CAACwC,IAAN,CAAWC,WAAX,CAAuBC,UAAvB,IAAqCf,IAAI,CAACS,MAAL,GAAc,CAAnD;AACD;AACF,GALD;;AAMA,MAAMO,kBAAkB,GAAGC,QAAQ,CAAC,YAAM;AACxC,WAAO/C,KAAK,CAACa,MAAN,IAAgBb,KAAK,CAACsB,SAAtB,IAAmCpB,KAAK,CAACuB,MAAN,CAAauB,YAAb,CAA0BtC,KAA1B,CAAgCuC,MAAhC,GAAyC,CAA5E,IAAiF/C,KAAK,CAACuB,MAAN,CAAayB,iBAAb,CAA+BxC,KAA/B,CAAqCuC,MAArC,GAA8C,CAAtI;AACD,GAFkC,CAAnC;AAGA,MAAME,eAAe,GAAGJ,QAAQ,CAAC,YAAM;AACrC,WAAO;AACLnC,WAAK,EAAEX,MAAM,CAACmD,SAAP,CAAiB1C,KAAjB,aAA4BT,MAAM,CAACmD,SAAP,CAAiB1C,KAA7C,UAAyD;AAD3D,KAAP;AAGD,GAJ+B,CAAhC;;AAKA,MAAM2C,QAAQ,GAAG,SAAXA,QAAW,GAAM;AACrB,QAAIP,kBAAkB,CAACpC,KAAvB,EAA8B;AAC5BT,YAAM,CAACqD,eAAP;AACD;;AACDrD,UAAM,CAACsD,kBAAP;AACAC,yBAAqB,CAACC,WAAD,CAArB;AACD,GAND;;AAOAC,WAAS,uEAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACFC,QAAQ,EADN;;AAAA;AAERzD,iBAAK,CAAC0D,aAAN;AACAC,sBAAU;AACVL,iCAAqB,CAACH,QAAD,CAArB;AACA1C,uBAAW,CAACD,KAAZ,GAAoB;AAClBE,mBAAK,EAAEM,UAAU,CAACR,KAAX,GAAmBP,KAAK,CAAC2D,KAAN,CAAYC,EAAZ,CAAeC,WADvB;AAElBnD,oBAAM,EAAEV,KAAK,CAAC2D,KAAN,CAAYC,EAAZ,CAAeE;AAFL,aAApB;AAIA/D,iBAAK,CAACuB,MAAN,CAAayC,OAAb,CAAqBxD,KAArB,CAA2ByD,OAA3B,CAAmC,UAACC,MAAD,EAAY;AAC7C,kBAAIA,MAAM,CAACC,aAAP,IAAwBD,MAAM,CAACC,aAAP,CAAqBpB,MAAjD,EAAyD;AACvD9C,qBAAK,CAACD,KAAN,CAAY6B,MAAZ,CAAmB,cAAnB,EAAmC;AACjCqC,wBAAM,EAANA,MADiC;AAEjCE,wBAAM,EAAEF,MAAM,CAACC,aAFkB;AAGjCE,wBAAM,EAAE;AAHyB,iBAAnC;AAKD;AACF,aARD;AASApE,iBAAK,CAACqE,MAAN,GAAe,IAAf;;AAlBQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAD,GAAT;;AAoBA,MAAMC,kBAAkB,GAAG,SAArBA,kBAAqB,CAACV,EAAD,EAAKW,SAAL,EAAmB;AAC5C,QAAI,CAACX,EAAL,EACE;AACF,QAAMY,SAAS,GAAGC,KAAK,CAACC,IAAN,CAAWd,EAAE,CAACY,SAAd,EAAyBG,MAAzB,CAAgC,UAACC,IAAD;AAAA,aAAU,CAACA,IAAI,CAACC,UAAL,CAAgB,eAAhB,CAAX;AAAA,KAAhC,CAAlB;AACAL,aAAS,CAACM,IAAV,CAAehF,MAAM,CAACiF,OAAP,CAAexE,KAAf,GAAuBgE,SAAvB,GAAmC,mBAAlD;AACAX,MAAE,CAACW,SAAH,GAAeC,SAAS,CAACQ,IAAV,CAAe,GAAf,CAAf;AACD,GAND;;AAOA,MAAMC,cAAc,GAAG,SAAjBA,cAAiB,CAACV,SAAD,EAAe;AACpC,QAAQW,YAAR,GAAyBlF,KAAK,CAACwC,IAA/B,CAAQ0C,YAAR;AACAZ,sBAAkB,CAACY,YAAD,EAAeX,SAAf,CAAlB;AACD,GAHD;;AAIA,MAAMY,cAAc,GAAG,SAAjBA,cAAiB,CAACZ,SAAD,EAAe;AACpC,QAAQW,YAAR,GAAyBlF,KAAK,CAACwC,IAA/B,CAAQ0C,YAAR;;AACA,QAAIA,YAAY,IAAIA,YAAY,CAACV,SAAb,CAAuBY,QAAvB,CAAgCb,SAAhC,CAApB,EAAgE;AAC9D,aAAO,IAAP;AACD;;AACD,WAAO,KAAP;AACD,GAND;;AAOA,MAAMjB,WAAW,GAAG,SAAdA,WAAc,GAAW;AAC7B,QAAI,CAACtD,KAAK,CAACwC,IAAN,CAAW6C,YAAhB,EACE;;AACF,QAAI,CAACvF,MAAM,CAACiF,OAAP,CAAexE,KAApB,EAA2B;AACzB,UAAM+E,kBAAkB,GAAG,mBAA3B;;AACA,UAAI,CAACH,cAAc,CAACG,kBAAD,CAAnB,EAAyC;AACvCL,sBAAc,CAACK,kBAAD,CAAd;AACD;;AACD;AACD;;AACD,QAAMC,eAAe,GAAGvF,KAAK,CAACwC,IAAN,CAAW6C,YAAX,CAAwBG,KAAhD;AACA,QAAI,CAACD,eAAL,EACE;AACF,QAAQ7C,UAAR,GAAiD6C,eAAjD,CAAQ7C,UAAR;AAAA,QAAoBmB,WAApB,GAAiD0B,eAAjD,CAAoB1B,WAApB;AAAA,QAAiC4B,WAAjC,GAAiDF,eAAjD,CAAiCE,WAAjC;AACA,sBAAyCzF,KAAK,CAACwC,IAA/C;AAAA,QAAQkD,aAAR,eAAQA,aAAR;AAAA,QAAuBC,aAAvB,eAAuBA,aAAvB;AACA,QAAID,aAAJ,EACEA,aAAa,CAAChD,UAAd,GAA2BA,UAA3B;AACF,QAAIiD,aAAJ,EACEA,aAAa,CAACjD,UAAd,GAA2BA,UAA3B;AACF,QAAMkD,qBAAqB,GAAGH,WAAW,GAAG5B,WAAd,GAA4B,CAA1D;;AACA,QAAInB,UAAU,IAAIkD,qBAAlB,EAAyC;AACvCX,oBAAc,CAAC,oBAAD,CAAd;AACD,KAFD,MAEO,IAAIvC,UAAU,KAAK,CAAnB,EAAsB;AAC3BuC,oBAAc,CAAC,mBAAD,CAAd;AACD,KAFM,MAEA;AACLA,oBAAc,CAAC,qBAAD,CAAd;AACD;AACF,GA3BD;;AA4BA,MAAMvB,UAAU,GAAG,SAAbA,UAAa,GAAM;AACvB,QAAImC,EAAJ;;AACA,QAAI,CAAC7F,KAAK,CAACwC,IAAN,CAAW6C,YAAhB,EACE;AACF,KAACQ,EAAE,GAAG7F,KAAK,CAACwC,IAAN,CAAW6C,YAAX,CAAwBG,KAA9B,KAAwC,IAAxC,GAA+C,KAAK,CAApD,GAAwDK,EAAE,CAACC,gBAAH,CAAoB,QAApB,EAA8BxC,WAA9B,EAA2C;AACjGyC,aAAO,EAAE;AADwF,KAA3C,CAAxD;;AAGA,QAAIlG,KAAK,CAACmG,GAAV,EAAe;AACbC,uBAAiB,CAACjG,KAAK,CAAC2D,KAAN,CAAYC,EAAb,EAAiBsC,cAAjB,CAAjB;AACD,KAFD,MAEO;AACLC,QAAE,CAACC,MAAD,EAAS,QAAT,EAAmBlD,QAAnB,CAAF;AACD;AACF,GAZD;;AAaAmD,iBAAe,CAAC,YAAM;AACpBC,gBAAY;AACb,GAFc,CAAf;;AAGA,MAAMA,YAAY,GAAG,SAAfA,YAAe,GAAM;AACzB,QAAIT,EAAJ;;AACA,KAACA,EAAE,GAAG7F,KAAK,CAACwC,IAAN,CAAW6C,YAAX,CAAwBG,KAA9B,KAAwC,IAAxC,GAA+C,KAAK,CAApD,GAAwDK,EAAE,CAACU,mBAAH,CAAuB,QAAvB,EAAiCjD,WAAjC,EAA8C,IAA9C,CAAxD;;AACA,QAAIzD,KAAK,CAACmG,GAAV,EAAe;AACbQ,0BAAoB,CAACxG,KAAK,CAAC2D,KAAN,CAAYC,EAAb,EAAiBsC,cAAjB,CAApB;AACD,KAFD,MAEO;AACLO,SAAG,CAACL,MAAD,EAAS,QAAT,EAAmBlD,QAAnB,CAAH;AACD;AACF,GARD;;AASA,MAAMgD,cAAc,GAAG,SAAjBA,cAAiB,GAAM;AAC3B,QAAI,CAAClG,KAAK,CAACqE,MAAX,EACE;AACF,QAAIqC,kBAAkB,GAAG,KAAzB;AACA,QAAM9C,EAAE,GAAG5D,KAAK,CAAC2D,KAAN,CAAYC,EAAvB;AACA,6BAA+CpD,WAAW,CAACD,KAA3D;AAAA,QAAeoG,QAAf,sBAAQlG,KAAR;AAAA,QAAiCmG,SAAjC,sBAAyBlG,MAAzB;AACA,QAAMD,KAAK,GAAGM,UAAU,CAACR,KAAX,GAAmBqD,EAAE,CAACC,WAApC;;AACA,QAAI8C,QAAQ,KAAKlG,KAAjB,EAAwB;AACtBiG,wBAAkB,GAAG,IAArB;AACD;;AACD,QAAMG,OAAO,GAAGjD,EAAE,CAACE,YAAnB;;AACA,QAAI,CAACjE,KAAK,CAACa,MAAN,IAAgBiC,kBAAkB,CAACpC,KAApC,KAA8CqG,SAAS,KAAKC,OAAhE,EAAyE;AACvEH,wBAAkB,GAAG,IAArB;AACD;;AACD,QAAIA,kBAAJ,EAAwB;AACtBlG,iBAAW,CAACD,KAAZ,GAAoB;AAClBE,aAAK,EAALA,KADkB;AAElBC,cAAM,EAAEmG;AAFU,OAApB;AAIA3D,cAAQ;AACT;AACF,GArBD;;AAsBA,MAAM4D,SAAS,GAAGC,OAAO,EAAzB;AACA,MAAM9D,SAAS,GAAGL,QAAQ,CAAC,YAAM;AAC/B,QAAmBoE,UAAnB,GAAwDlH,MAAxD,CAAQmD,SAAR;AAAA,QAA+BgE,OAA/B,GAAwDnH,MAAxD,CAA+BmH,OAA/B;AAAA,QAAwCC,WAAxC,GAAwDpH,MAAxD,CAAwCoH,WAAxC;AACA,WAAOF,UAAU,CAACzG,KAAX,aAAsByG,UAAU,CAACzG,KAAX,IAAoB0G,OAAO,CAAC1G,KAAR,GAAgB2G,WAAhB,GAA8B,CAAlD,CAAtB,UAAiF,EAAxF;AACD,GAHyB,CAA1B;AAIA,MAAMC,WAAW,GAAGvE,QAAQ,CAAC,YAAM;AACjC,QAAI/C,KAAK,CAACsB,SAAV,EACE,OAAO,OAAP;AACF,WAAOtB,KAAK,CAACsH,WAAb;AACD,GAJ2B,CAA5B;;AAKA,WAASC,aAAT,CAAuBjG,SAAvB,EAAkCkG,YAAlC,EAAgDC,YAAhD,EAA8D;AAC5D,QAAMC,eAAe,GAAGC,WAAW,CAACrG,SAAD,CAAnC;AACA,QAAMsG,iBAAiB,GAAG5H,KAAK,CAAC6H,UAAN,GAAmBJ,YAAnB,GAAkC,CAA5D;AACA,QAAIC,eAAe,KAAK,IAAxB,EACE;;AACF,QAAII,QAAQ,CAACJ,eAAD,CAAZ,EAA+B;AAC7B,4BAAeA,eAAf,gBAAoCF,YAApC,kBAAwDI,iBAAxD;AACD;;AACD,WAAOF,eAAe,GAAGF,YAAlB,GAAiCI,iBAAxC;AACD;;AACD,MAAM/G,MAAM,GAAGkC,QAAQ,CAAC,YAAM;AAC5B,QAAM0E,YAAY,GAAGxH,MAAM,CAACwH,YAAP,CAAoB/G,KAApB,IAA6B,CAAlD;AACA,QAAMqH,WAAW,GAAG9H,MAAM,CAAC+H,UAAP,CAAkBtH,KAAtC;AACA,QAAM8G,YAAY,GAAGvH,MAAM,CAACuH,YAAP,CAAoB9G,KAApB,IAA6B,CAAlD;;AACA,QAAIV,KAAK,CAACa,MAAV,EAAkB;AAChB,aAAOkH,WAAW,GAAGA,WAAH,GAAiB,KAAK,CAAxC;AACD,KAFD,MAEO,IAAI/H,KAAK,CAACsB,SAAV,EAAqB;AAC1B,aAAOiG,aAAa,CAACvH,KAAK,CAACsB,SAAP,EAAkBkG,YAAlB,EAAgCC,YAAhC,CAApB;AACD;;AACD,WAAO,KAAK,CAAZ;AACD,GAVsB,CAAvB;AAWA,MAAMO,UAAU,GAAGjF,QAAQ,CAAC,YAAM;AAChC,QAAM0E,YAAY,GAAGxH,MAAM,CAACwH,YAAP,CAAoB/G,KAApB,IAA6B,CAAlD;AACA,QAAMqH,WAAW,GAAG9H,MAAM,CAAC+H,UAAP,CAAkBtH,KAAtC;AACA,QAAM8G,YAAY,GAAGvH,MAAM,CAACuH,YAAP,CAAoB9G,KAApB,IAA6B,CAAlD;;AACA,QAAIV,KAAK,CAACa,MAAV,EAAkB;AAChB,aAAO;AACLA,cAAM,EAAEkH,WAAW,aAAMA,WAAN,UAAwB;AADtC,OAAP;AAGD,KAJD,MAIO,IAAI/H,KAAK,CAACsB,SAAV,EAAqB;AAC1B,UAAMA,SAAS,GAAGiG,aAAa,CAACvH,KAAK,CAACsB,SAAP,EAAkBkG,YAAlB,EAAgCC,YAAhC,CAA/B;;AACA,UAAInG,SAAS,KAAK,IAAlB,EAAwB;AACtB,eAAO;AACL,kCAAiBA,SAAjB,SAA6B2G,QAAQ,CAAC3G,SAAD,CAAR,GAAsB,IAAtB,GAA6B,EAA1D;AADK,SAAP;AAGD;AACF;;AACD,WAAO,EAAP;AACD,GAjB0B,CAA3B;AAkBA,MAAM4G,eAAe,GAAGnF,QAAQ,CAAC,YAAM;AACrC,QAAI/C,KAAK,CAAC8B,IAAN,IAAc9B,KAAK,CAAC8B,IAAN,CAAWmB,MAA7B,EACE,OAAO,IAAP;AACF,QAAI+D,OAAO,GAAG,MAAd;;AACA,QAAI/G,MAAM,CAACkI,YAAP,CAAoBzH,KAAxB,EAA+B;AAC7BsG,aAAO,yBAAkB/G,MAAM,CAACkI,YAAP,CAAoBzH,KAAtC,QAAP;AACD;;AACD,WAAO;AACLE,WAAK,EAAEM,UAAU,CAACR,KAAX,aAAsBQ,UAAU,CAACR,KAAjC,UAA6C,EAD/C;AAELG,YAAM,EAAEmG;AAFH,KAAP;AAID,GAX+B,CAAhC;;AAYA,MAAMoB,qBAAqB,GAAG,SAAxBA,qBAAwB,CAAC9F,KAAD,EAAQR,IAAR,EAAiB;AAC7C,QAAMc,WAAW,GAAGzC,KAAK,CAACwC,IAAN,CAAWC,WAA/B;;AACA,QAAIH,IAAI,CAACC,GAAL,CAASZ,IAAI,CAACuG,KAAd,IAAuB,CAA3B,EAA8B;AAC5B,UAAMC,gBAAgB,GAAG1F,WAAW,CAAC2F,SAArC;;AACA,UAAIzG,IAAI,CAACU,MAAL,GAAc,CAAd,IAAmB8F,gBAAgB,KAAK,CAA5C,EAA+C;AAC7ChG,aAAK,CAACkG,cAAN;AACD;;AACD,UAAI1G,IAAI,CAACU,MAAL,GAAc,CAAd,IAAmBI,WAAW,CAAC6F,YAAZ,GAA2B7F,WAAW,CAAC8F,YAAvC,GAAsDJ,gBAA7E,EAA+F;AAC7FhG,aAAK,CAACkG,cAAN;AACD;;AACD5F,iBAAW,CAAC2F,SAAZ,IAAyB9F,IAAI,CAACkG,IAAL,CAAU7G,IAAI,CAACU,MAAL,GAAc,CAAxB,CAAzB;AACD,KATD,MASO;AACLI,iBAAW,CAACC,UAAZ,IAA0BJ,IAAI,CAACkG,IAAL,CAAU7G,IAAI,CAACS,MAAL,GAAc,CAAxB,CAA1B;AACD;AACF,GAdD;;AAeA,MAAMqG,WAAW,GAAG7F,QAAQ,CAAC,YAAM;AACjC,QAAI/C,KAAK,CAACsB,SAAV,EAAqB;AACnB,UAAItB,KAAK,CAAC6I,WAAV,EAAuB;AACrB,eAAO;AACLC,gBAAM,EAAE;AADH,SAAP;AAGD;;AACD,aAAO;AACLA,cAAM,EAAE7I,MAAM,CAACiF,OAAP,CAAexE,KAAf,IAAwBV,KAAK,CAAC8B,IAAN,CAAWmB,MAAnC,aAA+ChD,MAAM,CAACoH,WAAtD,UAAwE;AAD3E,OAAP;AAGD,KATD,MASO;AACL,UAAIrH,KAAK,CAAC6I,WAAV,EAAuB;AACrB,eAAO;AACLhI,gBAAM,EAAEZ,MAAM,CAAC8I,WAAP,CAAmBrI,KAAnB,aAA8BT,MAAM,CAAC8I,WAAP,CAAmBrI,KAAjD,UAA6D;AADhE,SAAP;AAGD;;AACD,aAAO;AACLG,cAAM,EAAEZ,MAAM,CAAC+I,cAAP,CAAsBtI,KAAtB,aAAiCT,MAAM,CAAC+I,cAAP,CAAsBtI,KAAvD,UAAmE;AADtE,OAAP;AAGD;AACF,GApB2B,CAA5B;AAqBA,MAAMuI,eAAe,GAAGlG,QAAQ,CAAC,YAAM;AACrC,QAAI/C,KAAK,CAACa,MAAV,EAAkB;AAChB,aAAO;AACLA,cAAM,EAAEZ,MAAM,CAACgJ,eAAP,CAAuBvI,KAAvB,aAAkCT,MAAM,CAACgJ,eAAP,CAAuBvI,KAAzD,UAAqE;AADxE,OAAP;AAGD,KAJD,MAIO,IAAIV,KAAK,CAACsB,SAAV,EAAqB;AAC1B,UAAIA,SAAS,GAAGqG,WAAW,CAAC3H,KAAK,CAACsB,SAAP,CAA3B;;AACA,UAAI,OAAOA,SAAP,KAAqB,QAAzB,EAAmC;AACjCA,iBAAS,GAAGrB,MAAM,CAACiF,OAAP,CAAexE,KAAf,GAAuBY,SAAS,GAAGrB,MAAM,CAACoH,WAA1C,GAAwD/F,SAApE;;AACA,YAAItB,KAAK,CAAC6H,UAAV,EAAsB;AACpBvG,mBAAS,IAAIrB,MAAM,CAACwH,YAAP,CAAoB/G,KAAjC;AACD;;AACDY,iBAAS,IAAIrB,MAAM,CAACuH,YAAP,CAAoB9G,KAAjC;AACA,eAAO;AACL,kCAAiBY,SAAjB;AADK,SAAP;AAGD;AACF;;AACD,WAAO,EAAP;AACD,GAnB+B,CAAhC;AAoBA,SAAO;AACLlB,YAAQ,EAARA,QADK;AAELE,kBAAc,EAAdA,cAFK;AAGLE,kBAAc,EAAdA,cAHK;AAILM,WAAO,EAAPA,OAJK;AAKLqB,oBAAgB,EAAhBA,gBALK;AAMLE,gCAA4B,EAA5BA,4BANK;AAOL4E,aAAS,EAATA,SAPK;AAQLe,cAAU,EAAVA,UARK;AASLnH,UAAM,EAANA,MATK;AAULqH,mBAAe,EAAfA,eAVK;AAWLE,yBAAqB,EAArBA,qBAXK;AAYLQ,eAAW,EAAXA,WAZK;AAaLK,mBAAe,EAAfA,eAbK;AAcL1I,sBAAkB,EAAlBA,kBAdK;AAeL6C,aAAS,EAATA,SAfK;AAgBLzC,eAAW,EAAXA,WAhBK;AAiBL0C,YAAQ,EAARA,QAjBK;AAkBLF,mBAAe,EAAfA,eAlBK;AAmBLmE,eAAW,EAAXA,WAnBK;AAoBLvG,sBAAkB,EAAlBA;AApBK,GAAP;AAsBF","names":["useStyle","props","layout","store","table","isHidden","ref","renderExpanded","resizeProxyVisible","setDragVisible","visible","value","resizeState","width","height","isGroup","scrollbarViewStyle","display","verticalAlign","tableWidth","watchEffect","setHeight","setMaxHeight","maxHeight","watch","currentRowKey","states","rowKey","unref","setCurrentRowKey","immediate","data","commit","deep","expandRowKeys","setExpandRowKeysAdapter","handleMouseLeave","hoverState","handleHeaderFooterMousewheel","event","pixelX","pixelY","Math","abs","refs","bodyWrapper","scrollLeft","shouldUpdateHeight","computed","fixedColumns","length","rightFixedColumns","tableBodyStyles","bodyWidth","doLayout","updateElsHeight","updateColumnsWidth","requestAnimationFrame","syncPostion","onMounted","nextTick","updateColumns","bindEvents","vnode","el","offsetWidth","offsetHeight","columns","forEach","column","filteredValue","values","silent","$ready","setScrollClassByEl","className","classList","Array","from","filter","item","startsWith","push","scrollX","join","setScrollClass","tableWrapper","hasScrollClass","contains","scrollBarRef","scrollingNoneClass","scrollContainer","wrap$","scrollWidth","headerWrapper","footerWrapper","maxScrollLeftPosition","_a","addEventListener","passive","fit","addResizeListener","resizeListener","on","window","onBeforeUnmount","unbindEvents","removeEventListener","removeResizeListener","off","shouldUpdateLayout","oldWidth","oldHeight","height2","tableSize","useSize","bodyWidth_","scrollY","gutterWidth","tableLayout","calcMaxHeight","footerHeight","headerHeight","parsedMaxHeight","parseHeight","tableHeaderHeight","showHeader","isString","bodyHeight2","bodyHeight","isNumber","emptyBlockStyle","appendHeight","handleFixedMousewheel","spinY","currentScrollTop","scrollTop","preventDefault","scrollHeight","clientHeight","ceil","fixedHeight","showSummary","bottom","tableHeight","viewportHeight","fixedBodyHeight"],"sources":["../../../../../../../packages/components/table/src/table/style-helper.ts"],"sourcesContent":["import {\n  computed,\n  nextTick,\n  onBeforeUnmount,\n  onMounted,\n  ref,\n  unref,\n  watch,\n  watchEffect,\n} from 'vue'\nimport {\n  addResizeListener,\n  isNumber,\n  isString,\n  off,\n  on,\n  removeResizeListener,\n} from '@element-plus/utils'\nimport { useSize } from '@element-plus/hooks'\nimport { parseHeight } from '../util'\n\nimport type { ResizableElement } from '@element-plus/utils'\nimport type { Table, TableProps } from './defaults'\nimport type { Store } from '../store'\nimport type TableLayout from '../table-layout'\nimport type { TableColumnCtx } from '../table-column/defaults'\n\nfunction useStyle<T>(\n  props: TableProps<T>,\n  layout: TableLayout<T>,\n  store: Store<T>,\n  table: Table<T>\n) {\n  const isHidden = ref(false)\n  const renderExpanded = ref(null)\n  const resizeProxyVisible = ref(false)\n  const setDragVisible = (visible: boolean) => {\n    resizeProxyVisible.value = visible\n  }\n  const resizeState = ref({\n    width: null,\n    height: null,\n  })\n  const isGroup = ref(false)\n  const scrollbarViewStyle = {\n    display: 'inline-block',\n    verticalAlign: 'middle',\n  }\n  const tableWidth = ref()\n\n  watchEffect(() => {\n    layout.setHeight(props.height)\n  })\n  watchEffect(() => {\n    layout.setMaxHeight(props.maxHeight)\n  })\n  watch(\n    () => [props.currentRowKey, store.states.rowKey],\n    ([currentRowKey, rowKey]) => {\n      if (!unref(rowKey)) return\n      store.setCurrentRowKey(`${currentRowKey}`)\n    },\n    {\n      immediate: true,\n    }\n  )\n  watch(\n    () => props.data,\n    (data) => {\n      table.store.commit('setData', data)\n    },\n    {\n      immediate: true,\n      deep: true,\n    }\n  )\n  watchEffect(() => {\n    if (props.expandRowKeys) {\n      store.setExpandRowKeysAdapter(props.expandRowKeys)\n    }\n  })\n\n  const handleMouseLeave = () => {\n    table.store.commit('setHoverRow', null)\n    if (table.hoverState) table.hoverState = null\n  }\n\n  const handleHeaderFooterMousewheel = (event, data) => {\n    const { pixelX, pixelY } = data\n    if (Math.abs(pixelX) >= Math.abs(pixelY)) {\n      table.refs.bodyWrapper.scrollLeft += data.pixelX / 5\n    }\n  }\n\n  const shouldUpdateHeight = computed(() => {\n    return (\n      props.height ||\n      props.maxHeight ||\n      store.states.fixedColumns.value.length > 0 ||\n      store.states.rightFixedColumns.value.length > 0\n    )\n  })\n\n  const tableBodyStyles = computed(() => {\n    return {\n      width: layout.bodyWidth.value ? `${layout.bodyWidth.value}px` : '',\n    }\n  })\n\n  const doLayout = () => {\n    if (shouldUpdateHeight.value) {\n      layout.updateElsHeight()\n    }\n    layout.updateColumnsWidth()\n    requestAnimationFrame(syncPostion)\n  }\n  onMounted(async () => {\n    await nextTick()\n    store.updateColumns()\n    bindEvents()\n    requestAnimationFrame(doLayout)\n\n    resizeState.value = {\n      width: (tableWidth.value = table.vnode.el.offsetWidth),\n      height: table.vnode.el.offsetHeight,\n    }\n\n    // init filters\n    store.states.columns.value.forEach((column: TableColumnCtx<T>) => {\n      if (column.filteredValue && column.filteredValue.length) {\n        table.store.commit('filterChange', {\n          column,\n          values: column.filteredValue,\n          silent: true,\n        })\n      }\n    })\n    table.$ready = true\n  })\n  const setScrollClassByEl = (el: HTMLElement, className: string) => {\n    if (!el) return\n    const classList = Array.from(el.classList).filter(\n      (item) => !item.startsWith('is-scrolling-')\n    )\n    classList.push(layout.scrollX.value ? className : 'is-scrolling-none')\n    el.className = classList.join(' ')\n  }\n  const setScrollClass = (className: string) => {\n    const { tableWrapper } = table.refs\n    setScrollClassByEl(tableWrapper, className)\n  }\n  const hasScrollClass = (className: string) => {\n    const { tableWrapper } = table.refs\n    if (tableWrapper && tableWrapper.classList.contains(className)) {\n      return true\n    }\n    return false\n  }\n  const syncPostion = function () {\n    if (!table.refs.scrollBarRef) return\n    if (!layout.scrollX.value) {\n      const scrollingNoneClass = 'is-scrolling-none'\n      if (!hasScrollClass(scrollingNoneClass)) {\n        setScrollClass(scrollingNoneClass)\n      }\n      return\n    }\n    const scrollContainer = table.refs.scrollBarRef.wrap$\n    if (!scrollContainer) return\n    const { scrollLeft, offsetWidth, scrollWidth } = scrollContainer\n    const { headerWrapper, footerWrapper } = table.refs\n    if (headerWrapper) headerWrapper.scrollLeft = scrollLeft\n    if (footerWrapper) footerWrapper.scrollLeft = scrollLeft\n    const maxScrollLeftPosition = scrollWidth - offsetWidth - 1\n    if (scrollLeft >= maxScrollLeftPosition) {\n      setScrollClass('is-scrolling-right')\n    } else if (scrollLeft === 0) {\n      setScrollClass('is-scrolling-left')\n    } else {\n      setScrollClass('is-scrolling-middle')\n    }\n  }\n\n  const bindEvents = () => {\n    if (!table.refs.scrollBarRef) return\n    table.refs.scrollBarRef.wrap$?.addEventListener('scroll', syncPostion, {\n      passive: true,\n    })\n    if (props.fit) {\n      addResizeListener(table.vnode.el as ResizableElement, resizeListener)\n    } else {\n      on(window, 'resize', doLayout)\n    }\n  }\n  onBeforeUnmount(() => {\n    unbindEvents()\n  })\n  const unbindEvents = () => {\n    table.refs.scrollBarRef.wrap$?.removeEventListener(\n      'scroll',\n      syncPostion,\n      true\n    )\n    if (props.fit) {\n      removeResizeListener(table.vnode.el as ResizableElement, resizeListener)\n    } else {\n      off(window, 'resize', doLayout)\n    }\n  }\n  const resizeListener = () => {\n    if (!table.$ready) return\n    let shouldUpdateLayout = false\n    const el = table.vnode.el\n    const { width: oldWidth, height: oldHeight } = resizeState.value\n\n    const width = (tableWidth.value = el.offsetWidth)\n    if (oldWidth !== width) {\n      shouldUpdateLayout = true\n    }\n\n    const height = el.offsetHeight\n    if ((props.height || shouldUpdateHeight.value) && oldHeight !== height) {\n      shouldUpdateLayout = true\n    }\n\n    if (shouldUpdateLayout) {\n      resizeState.value = {\n        width,\n        height,\n      }\n      doLayout()\n    }\n  }\n  const tableSize = useSize()\n  const bodyWidth = computed(() => {\n    const { bodyWidth: bodyWidth_, scrollY, gutterWidth } = layout\n    return bodyWidth_.value\n      ? `${(bodyWidth_.value as number) - (scrollY.value ? gutterWidth : 0)}px`\n      : ''\n  })\n\n  const tableLayout = computed(() => {\n    if (props.maxHeight) return 'fixed'\n    return props.tableLayout\n  })\n\n  function calcMaxHeight(\n    maxHeight: string | number,\n    footerHeight: number,\n    headerHeight: number\n  ) {\n    const parsedMaxHeight = parseHeight(maxHeight)\n    const tableHeaderHeight = props.showHeader ? headerHeight : 0\n    if (parsedMaxHeight === null) return\n    if (isString(parsedMaxHeight)) {\n      return `calc(${parsedMaxHeight} - ${footerHeight}px - ${tableHeaderHeight}px)`\n    }\n    return parsedMaxHeight - footerHeight - tableHeaderHeight\n  }\n\n  const height = computed(() => {\n    const headerHeight = layout.headerHeight.value || 0\n    const bodyHeight = layout.bodyHeight.value\n    const footerHeight = layout.footerHeight.value || 0\n    if (props.height) {\n      return bodyHeight ? bodyHeight : undefined\n    } else if (props.maxHeight) {\n      return calcMaxHeight(props.maxHeight, footerHeight, headerHeight)\n    }\n    return undefined\n  })\n\n  const bodyHeight = computed(() => {\n    const headerHeight = layout.headerHeight.value || 0\n    const bodyHeight = layout.bodyHeight.value\n    const footerHeight = layout.footerHeight.value || 0\n    if (props.height) {\n      return {\n        height: bodyHeight ? `${bodyHeight}px` : '',\n      }\n    } else if (props.maxHeight) {\n      const maxHeight = calcMaxHeight(\n        props.maxHeight,\n        footerHeight,\n        headerHeight\n      )\n      if (maxHeight !== null) {\n        return {\n          'max-height': `${maxHeight}${isNumber(maxHeight) ? 'px' : ''}`,\n        }\n      }\n    }\n    return {}\n  })\n  const emptyBlockStyle = computed(() => {\n    if (props.data && props.data.length) return null\n    let height = '100%'\n    if (layout.appendHeight.value) {\n      height = `calc(100% - ${layout.appendHeight.value}px)`\n    }\n    return {\n      width: tableWidth.value ? `${tableWidth.value}px` : '',\n      height,\n    }\n  })\n  /**\n   * fix layout\n   */\n  const handleFixedMousewheel = (event, data) => {\n    const bodyWrapper = table.refs.bodyWrapper\n    if (Math.abs(data.spinY) > 0) {\n      const currentScrollTop = bodyWrapper.scrollTop\n      if (data.pixelY < 0 && currentScrollTop !== 0) {\n        event.preventDefault()\n      }\n      if (\n        data.pixelY > 0 &&\n        bodyWrapper.scrollHeight - bodyWrapper.clientHeight > currentScrollTop\n      ) {\n        event.preventDefault()\n      }\n      bodyWrapper.scrollTop += Math.ceil(data.pixelY / 5)\n    } else {\n      bodyWrapper.scrollLeft += Math.ceil(data.pixelX / 5)\n    }\n  }\n  const fixedHeight = computed(() => {\n    if (props.maxHeight) {\n      if (props.showSummary) {\n        return {\n          bottom: 0,\n        }\n      }\n      return {\n        bottom:\n          layout.scrollX.value && props.data.length\n            ? `${layout.gutterWidth}px`\n            : '',\n      }\n    } else {\n      if (props.showSummary) {\n        return {\n          height: layout.tableHeight.value\n            ? `${layout.tableHeight.value}px`\n            : '',\n        }\n      }\n      return {\n        height: layout.viewportHeight.value\n          ? `${layout.viewportHeight.value}px`\n          : '',\n      }\n    }\n  })\n  const fixedBodyHeight = computed(() => {\n    if (props.height) {\n      return {\n        height: layout.fixedBodyHeight.value\n          ? `${layout.fixedBodyHeight.value}px`\n          : '',\n      }\n    } else if (props.maxHeight) {\n      let maxHeight = parseHeight(props.maxHeight)\n      if (typeof maxHeight === 'number') {\n        maxHeight = layout.scrollX.value\n          ? maxHeight - layout.gutterWidth\n          : maxHeight\n        if (props.showHeader) {\n          maxHeight -= layout.headerHeight.value\n        }\n        maxHeight -= layout.footerHeight.value\n        return {\n          'max-height': `${maxHeight}px`,\n        }\n      }\n    }\n    return {}\n  })\n\n  return {\n    isHidden,\n    renderExpanded,\n    setDragVisible,\n    isGroup,\n    handleMouseLeave,\n    handleHeaderFooterMousewheel,\n    tableSize,\n    bodyHeight,\n    height,\n    emptyBlockStyle,\n    handleFixedMousewheel,\n    fixedHeight,\n    fixedBodyHeight,\n    resizeProxyVisible,\n    bodyWidth,\n    resizeState,\n    doLayout,\n    tableBodyStyles,\n    tableLayout,\n    scrollbarViewStyle,\n  }\n}\n\nexport default useStyle\n"]},"metadata":{},"sourceType":"module"}