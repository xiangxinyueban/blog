{"ast":null,"code":"import _objectSpread from \"C:/PartTimeJob/blog/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _asyncToGenerator from \"C:/PartTimeJob/blog/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"regenerator-runtime/runtime.js\";\nimport \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport { isRef, ref, unref, onMounted, watchEffect } from 'vue';\nimport { isClient, unrefElement } from '@vueuse/core';\nimport { isNil } from 'lodash-unified';\nimport { computePosition, arrow } from '@floating-ui/dom';\nimport '../../utils/index.mjs';\nimport { buildProps } from '../../utils/vue/props.mjs';\nvar useFloatingProps = buildProps({});\n\nvar unrefReference = function unrefReference(elRef) {\n  if (!isClient) return;\n  if (!elRef) return elRef;\n  var unrefEl = unrefElement(elRef);\n  if (unrefEl) return unrefEl;\n  return isRef(elRef) ? unrefEl : elRef;\n};\n\nvar getPositionDataWithUnit = function getPositionDataWithUnit(record, key) {\n  var value = record == null ? void 0 : record[key];\n  return isNil(value) ? \"\" : \"\".concat(value, \"px\");\n};\n\nvar useFloating = function useFloating(_ref) {\n  var middleware = _ref.middleware,\n      placement = _ref.placement,\n      strategy = _ref.strategy;\n  var referenceRef = ref();\n  var contentRef = ref();\n  var x = ref();\n  var y = ref();\n  var middlewareData = ref({});\n  var states = {\n    x: x,\n    y: y,\n    placement: placement,\n    strategy: strategy,\n    middlewareData: middlewareData\n  };\n\n  var update = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n      var referenceEl, contentEl, data;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (isClient) {\n                _context.next = 2;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 2:\n              referenceEl = unrefReference(referenceRef);\n              contentEl = unrefElement(contentRef);\n\n              if (!(!referenceEl || !contentEl)) {\n                _context.next = 6;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 6:\n              _context.next = 8;\n              return computePosition(referenceEl, contentEl, {\n                placement: unref(placement),\n                strategy: unref(strategy),\n                middleware: unref(middleware)\n              });\n\n            case 8:\n              data = _context.sent;\n              Object.keys(states).forEach(function (key) {\n                states[key].value = data[key];\n              });\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function update() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  onMounted(function () {\n    watchEffect(function () {\n      update();\n    });\n  });\n  return _objectSpread(_objectSpread({}, states), {}, {\n    update: update,\n    referenceRef: referenceRef,\n    contentRef: contentRef\n  });\n};\n\nvar arrowMiddleware = function arrowMiddleware(_ref3) {\n  var arrowRef = _ref3.arrowRef,\n      padding = _ref3.padding;\n  return {\n    name: \"arrow\",\n    options: {\n      element: arrowRef,\n      padding: padding\n    },\n    fn: function fn(args) {\n      var arrowEl = unref(arrowRef);\n      if (!arrowEl) return {};\n      return arrow({\n        element: arrowEl,\n        padding: padding\n      }).fn(args);\n    }\n  };\n};\n\nexport { arrowMiddleware, getPositionDataWithUnit, useFloating, useFloatingProps };","map":{"version":3,"mappings":"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","names":["useFloatingProps","buildProps","unrefReference","elRef","isClient","unrefEl","unrefElement","isRef","getPositionDataWithUnit","record","key","value","isNil","useFloating","middleware","placement","strategy","referenceRef","ref","contentRef","x","y","middlewareData","states","update","referenceEl","contentEl","computePosition","unref","data","Object","keys","forEach","onMounted","watchEffect","arrowMiddleware","arrowRef","padding","name","options","element","fn","args","arrowEl","arrowCore"],"sources":["../../../../../packages/hooks/use-floating/index.ts"],"sourcesContent":["import { isRef, onMounted, ref, unref, watchEffect } from 'vue'\nimport { isClient, unrefElement } from '@vueuse/core'\nimport { isNil } from 'lodash-unified'\nimport { arrow as arrowCore, computePosition } from '@floating-ui/dom'\n\nimport { buildProps } from '@element-plus/utils'\n\nimport type { Ref, ToRefs } from 'vue'\nimport type {\n  ComputePositionReturn,\n  Middleware,\n  Placement,\n  SideObject,\n  Strategy,\n  VirtualElement,\n} from '@floating-ui/dom'\n\nexport const useFloatingProps = buildProps({} as const)\n\nexport type UseFloatingProps = ToRefs<{\n  middleware: Array<Middleware>\n  placement: Placement\n  strategy: Strategy\n}>\n\ntype ElementRef = Parameters<typeof unrefElement>['0']\n\nconst unrefReference = (\n  elRef: ElementRef | Ref<VirtualElement | undefined>\n) => {\n  if (!isClient) return\n  if (!elRef) return elRef\n  const unrefEl = unrefElement(elRef as ElementRef)\n  if (unrefEl) return unrefEl\n  return isRef(elRef) ? unrefEl : (elRef as VirtualElement)\n}\n\nexport const getPositionDataWithUnit = <T extends Record<string, number>>(\n  record: T | undefined,\n  key: keyof T\n) => {\n  const value = record?.[key]\n  return isNil(value) ? '' : `${value}px`\n}\n\nexport const useFloating = ({\n  middleware,\n  placement,\n  strategy,\n}: UseFloatingProps) => {\n  const referenceRef = ref<HTMLElement | VirtualElement>()\n  const contentRef = ref<HTMLElement>()\n  const x = ref<number>()\n  const y = ref<number>()\n  const middlewareData = ref<ComputePositionReturn['middlewareData']>({})\n\n  const states = {\n    x,\n    y,\n    placement,\n    strategy,\n    middlewareData,\n  } as const\n\n  const update = async () => {\n    if (!isClient) return\n\n    const referenceEl = unrefReference(referenceRef)\n    const contentEl = unrefElement(contentRef)\n    if (!referenceEl || !contentEl) return\n\n    const data = await computePosition(referenceEl, contentEl, {\n      placement: unref(placement),\n      strategy: unref(strategy),\n      middleware: unref(middleware),\n    })\n\n    Object.keys(states).forEach((key) => {\n      states[key].value = data[key]\n    })\n  }\n\n  onMounted(() => {\n    watchEffect(() => {\n      update()\n    })\n  })\n\n  return {\n    ...states,\n    update,\n    referenceRef,\n    contentRef,\n  }\n}\n\nexport type ArrowMiddlewareProps = {\n  arrowRef: Ref<HTMLElement | null>\n  padding?: number | SideObject\n}\n\nexport const arrowMiddleware = ({\n  arrowRef,\n  padding,\n}: ArrowMiddlewareProps): Middleware => {\n  return {\n    name: 'arrow',\n    options: {\n      element: arrowRef,\n      padding,\n    },\n\n    fn(args) {\n      const arrowEl = unref(arrowRef)\n      if (!arrowEl) return {}\n\n      return arrowCore({\n        element: arrowEl,\n        padding,\n      }).fn(args)\n    },\n  }\n}\n"]},"metadata":{},"sourceType":"module"}