{"ast":null,"code":"import \"core-js/modules/es.number.parse-int.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/web.timers.js\";\nimport \"core-js/modules/es.array.index-of.js\";\nimport { getCurrentInstance, inject, ref } from 'vue';\nimport { isClient } from '@vueuse/core';\nimport '../../../../utils/index.mjs';\nimport { TABLE_INJECTION_KEY } from '../tokens.mjs';\nimport { addClass, removeClass, hasClass } from '../../../../utils/dom/style.mjs';\n\nfunction useEvent(props, emit) {\n  var instance = getCurrentInstance();\n  var parent = inject(TABLE_INJECTION_KEY);\n\n  var handleFilterClick = function handleFilterClick(event) {\n    event.stopPropagation();\n    return;\n  };\n\n  var handleHeaderClick = function handleHeaderClick(event, column) {\n    if (!column.filters && column.sortable) {\n      handleSortClick(event, column, false);\n    } else if (column.filterable && !column.sortable) {\n      handleFilterClick(event);\n    }\n\n    parent == null ? void 0 : parent.emit(\"header-click\", column, event);\n  };\n\n  var handleHeaderContextMenu = function handleHeaderContextMenu(event, column) {\n    parent == null ? void 0 : parent.emit(\"header-contextmenu\", column, event);\n  };\n\n  var draggingColumn = ref(null);\n  var dragging = ref(false);\n  var dragState = ref({});\n\n  var handleMouseDown = function handleMouseDown(event, column) {\n    if (!isClient) return;\n    if (column.children && column.children.length > 0) return;\n\n    if (draggingColumn.value && props.border) {\n      dragging.value = true;\n      var table = parent;\n      emit(\"set-drag-visible\", true);\n      var tableEl = table == null ? void 0 : table.vnode.el;\n      var tableLeft = tableEl.getBoundingClientRect().left;\n      var columnEl = instance.vnode.el.querySelector(\"th.\".concat(column.id));\n      var columnRect = columnEl.getBoundingClientRect();\n      var minLeft = columnRect.left - tableLeft + 30;\n      addClass(columnEl, \"noclick\");\n      dragState.value = {\n        startMouseLeft: event.clientX,\n        startLeft: columnRect.right - tableLeft,\n        startColumnLeft: columnRect.left - tableLeft,\n        tableLeft: tableLeft\n      };\n      var resizeProxy = table == null ? void 0 : table.refs.resizeProxy;\n      resizeProxy.style.left = \"\".concat(dragState.value.startLeft, \"px\");\n\n      document.onselectstart = function () {\n        return false;\n      };\n\n      document.ondragstart = function () {\n        return false;\n      };\n\n      var handleMouseMove2 = function handleMouseMove2(event2) {\n        var deltaLeft = event2.clientX - dragState.value.startMouseLeft;\n        var proxyLeft = dragState.value.startLeft + deltaLeft;\n        resizeProxy.style.left = \"\".concat(Math.max(minLeft, proxyLeft), \"px\");\n      };\n\n      var handleMouseUp = function handleMouseUp() {\n        if (dragging.value) {\n          var _dragState$value = dragState.value,\n              startColumnLeft = _dragState$value.startColumnLeft,\n              startLeft = _dragState$value.startLeft;\n          var finalLeft = Number.parseInt(resizeProxy.style.left, 10);\n          var columnWidth = finalLeft - startColumnLeft;\n          column.width = column.realWidth = columnWidth;\n          table == null ? void 0 : table.emit(\"header-dragend\", column.width, startLeft - startColumnLeft, column, event);\n          requestAnimationFrame(function () {\n            props.store.scheduleLayout(false, true);\n          });\n          document.body.style.cursor = \"\";\n          dragging.value = false;\n          draggingColumn.value = null;\n          dragState.value = {};\n          emit(\"set-drag-visible\", false);\n        }\n\n        document.removeEventListener(\"mousemove\", handleMouseMove2);\n        document.removeEventListener(\"mouseup\", handleMouseUp);\n        document.onselectstart = null;\n        document.ondragstart = null;\n        setTimeout(function () {\n          removeClass(columnEl, \"noclick\");\n        }, 0);\n      };\n\n      document.addEventListener(\"mousemove\", handleMouseMove2);\n      document.addEventListener(\"mouseup\", handleMouseUp);\n    }\n  };\n\n  var handleMouseMove = function handleMouseMove(event, column) {\n    if (column.children && column.children.length > 0) return;\n    var target = event.target;\n\n    while (target && target.tagName !== \"TH\") {\n      target = target.parentNode;\n    }\n\n    if (!column || !column.resizable) return;\n\n    if (!dragging.value && props.border) {\n      var rect = target.getBoundingClientRect();\n      var bodyStyle = document.body.style;\n\n      if (rect.width > 12 && rect.right - event.pageX < 8) {\n        bodyStyle.cursor = \"col-resize\";\n\n        if (hasClass(target, \"is-sortable\")) {\n          target.style.cursor = \"col-resize\";\n        }\n\n        draggingColumn.value = column;\n      } else if (!dragging.value) {\n        bodyStyle.cursor = \"\";\n\n        if (hasClass(target, \"is-sortable\")) {\n          target.style.cursor = \"pointer\";\n        }\n\n        draggingColumn.value = null;\n      }\n    }\n  };\n\n  var handleMouseOut = function handleMouseOut() {\n    if (!isClient) return;\n    document.body.style.cursor = \"\";\n  };\n\n  var toggleOrder = function toggleOrder(_ref) {\n    var order = _ref.order,\n        sortOrders = _ref.sortOrders;\n    if (order === \"\") return sortOrders[0];\n    var index = sortOrders.indexOf(order || null);\n    return sortOrders[index > sortOrders.length - 2 ? 0 : index + 1];\n  };\n\n  var handleSortClick = function handleSortClick(event, column, givenOrder) {\n    event.stopPropagation();\n    var order = column.order === givenOrder ? null : givenOrder || toggleOrder(column);\n    var target = event.target;\n\n    while (target && target.tagName !== \"TH\") {\n      target = target.parentNode;\n    }\n\n    if (target && target.tagName === \"TH\") {\n      if (hasClass(target, \"noclick\")) {\n        removeClass(target, \"noclick\");\n        return;\n      }\n    }\n\n    if (!column.sortable) return;\n    var states = props.store.states;\n    var sortProp = states.sortProp.value;\n    var sortOrder;\n    var sortingColumn = states.sortingColumn.value;\n\n    if (sortingColumn !== column || sortingColumn === column && sortingColumn.order === null) {\n      if (sortingColumn) {\n        sortingColumn.order = null;\n      }\n\n      states.sortingColumn.value = column;\n      sortProp = column.property;\n    }\n\n    if (!order) {\n      sortOrder = column.order = null;\n    } else {\n      sortOrder = column.order = order;\n    }\n\n    states.sortProp.value = sortProp;\n    states.sortOrder.value = sortOrder;\n    parent == null ? void 0 : parent.store.commit(\"changeSortCondition\");\n  };\n\n  return {\n    handleHeaderClick: handleHeaderClick,\n    handleHeaderContextMenu: handleHeaderContextMenu,\n    handleMouseDown: handleMouseDown,\n    handleMouseMove: handleMouseMove,\n    handleMouseOut: handleMouseOut,\n    handleSortClick: handleSortClick,\n    handleFilterClick: handleFilterClick\n  };\n}\n\nexport { useEvent as default };","map":{"version":3,"mappings":"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","names":["useEvent","props","emit","instance","getCurrentInstance","parent","inject","TABLE_INJECTION_KEY","handleFilterClick","event","stopPropagation","handleHeaderClick","column","filters","sortable","handleSortClick","filterable","handleHeaderContextMenu","draggingColumn","ref","dragging","dragState","handleMouseDown","isClient","children","length","value","border","table","tableEl","vnode","el","tableLeft","getBoundingClientRect","left","columnEl","querySelector","id","columnRect","minLeft","addClass","startMouseLeft","clientX","startLeft","right","startColumnLeft","resizeProxy","refs","style","document","onselectstart","ondragstart","handleMouseMove2","event2","deltaLeft","proxyLeft","Math","max","handleMouseUp","finalLeft","Number","parseInt","columnWidth","width","realWidth","requestAnimationFrame","store","scheduleLayout","body","cursor","removeEventListener","setTimeout","removeClass","addEventListener","handleMouseMove","target","tagName","parentNode","resizable","rect","bodyStyle","pageX","hasClass","handleMouseOut","toggleOrder","order","sortOrders","index","indexOf","givenOrder","states","sortProp","sortOrder","sortingColumn","property","commit"],"sources":["../../../../../../../packages/components/table/src/table-header/event-helper.ts"],"sourcesContent":["import { getCurrentInstance, inject, ref } from 'vue'\nimport { isClient } from '@vueuse/core'\nimport { addClass, hasClass, removeClass } from '@element-plus/utils'\nimport { TABLE_INJECTION_KEY } from '../tokens'\nimport type { TableHeaderProps } from '.'\nimport type { TableColumnCtx } from '../table-column/defaults'\n\nfunction useEvent<T>(props: TableHeaderProps<T>, emit) {\n  const instance = getCurrentInstance()\n  const parent = inject(TABLE_INJECTION_KEY)\n  const handleFilterClick = (event: Event) => {\n    event.stopPropagation()\n    return\n  }\n\n  const handleHeaderClick = (event: Event, column: TableColumnCtx<T>) => {\n    if (!column.filters && column.sortable) {\n      handleSortClick(event, column, false)\n    } else if (column.filterable && !column.sortable) {\n      handleFilterClick(event)\n    }\n    parent?.emit('header-click', column, event)\n  }\n\n  const handleHeaderContextMenu = (event: Event, column: TableColumnCtx<T>) => {\n    parent?.emit('header-contextmenu', column, event)\n  }\n  const draggingColumn = ref(null)\n  const dragging = ref(false)\n  const dragState = ref({})\n  const handleMouseDown = (event: MouseEvent, column: TableColumnCtx<T>) => {\n    if (!isClient) return\n    if (column.children && column.children.length > 0) return\n    /* istanbul ignore if */\n    if (draggingColumn.value && props.border) {\n      dragging.value = true\n\n      const table = parent\n      emit('set-drag-visible', true)\n      const tableEl = table?.vnode.el\n      const tableLeft = tableEl.getBoundingClientRect().left\n      const columnEl = instance.vnode.el.querySelector(`th.${column.id}`)\n      const columnRect = columnEl.getBoundingClientRect()\n      const minLeft = columnRect.left - tableLeft + 30\n\n      addClass(columnEl, 'noclick')\n\n      dragState.value = {\n        startMouseLeft: event.clientX,\n        startLeft: columnRect.right - tableLeft,\n        startColumnLeft: columnRect.left - tableLeft,\n        tableLeft,\n      }\n      const resizeProxy = table?.refs.resizeProxy as HTMLElement\n      resizeProxy.style.left = `${(dragState.value as any).startLeft}px`\n\n      document.onselectstart = function () {\n        return false\n      }\n      document.ondragstart = function () {\n        return false\n      }\n\n      const handleMouseMove = (event: MouseEvent) => {\n        const deltaLeft =\n          event.clientX - (dragState.value as any).startMouseLeft\n        const proxyLeft = (dragState.value as any).startLeft + deltaLeft\n\n        resizeProxy.style.left = `${Math.max(minLeft, proxyLeft)}px`\n      }\n\n      const handleMouseUp = () => {\n        if (dragging.value) {\n          const { startColumnLeft, startLeft } = dragState.value as any\n          const finalLeft = Number.parseInt(resizeProxy.style.left, 10)\n          const columnWidth = finalLeft - startColumnLeft\n          column.width = column.realWidth = columnWidth\n          table?.emit(\n            'header-dragend',\n            column.width,\n            startLeft - startColumnLeft,\n            column,\n            event\n          )\n          requestAnimationFrame(() => {\n            props.store.scheduleLayout(false, true)\n          })\n          document.body.style.cursor = ''\n          dragging.value = false\n          draggingColumn.value = null\n          dragState.value = {}\n          emit('set-drag-visible', false)\n        }\n\n        document.removeEventListener('mousemove', handleMouseMove)\n        document.removeEventListener('mouseup', handleMouseUp)\n        document.onselectstart = null\n        document.ondragstart = null\n\n        setTimeout(() => {\n          removeClass(columnEl, 'noclick')\n        }, 0)\n      }\n\n      document.addEventListener('mousemove', handleMouseMove)\n      document.addEventListener('mouseup', handleMouseUp)\n    }\n  }\n\n  const handleMouseMove = (event: MouseEvent, column: TableColumnCtx<T>) => {\n    if (column.children && column.children.length > 0) return\n    let target = event.target as HTMLElement\n    while (target && target.tagName !== 'TH') {\n      target = target.parentNode as HTMLElement\n    }\n\n    if (!column || !column.resizable) return\n\n    if (!dragging.value && props.border) {\n      const rect = target.getBoundingClientRect()\n\n      const bodyStyle = document.body.style\n      if (rect.width > 12 && rect.right - event.pageX < 8) {\n        bodyStyle.cursor = 'col-resize'\n        if (hasClass(target, 'is-sortable')) {\n          target.style.cursor = 'col-resize'\n        }\n        draggingColumn.value = column\n      } else if (!dragging.value) {\n        bodyStyle.cursor = ''\n        if (hasClass(target, 'is-sortable')) {\n          target.style.cursor = 'pointer'\n        }\n        draggingColumn.value = null\n      }\n    }\n  }\n\n  const handleMouseOut = () => {\n    if (!isClient) return\n    document.body.style.cursor = ''\n  }\n  const toggleOrder = ({ order, sortOrders }) => {\n    if (order === '') return sortOrders[0]\n    const index = sortOrders.indexOf(order || null)\n    return sortOrders[index > sortOrders.length - 2 ? 0 : index + 1]\n  }\n  const handleSortClick = (\n    event: Event,\n    column: TableColumnCtx<T>,\n    givenOrder: string | boolean\n  ) => {\n    event.stopPropagation()\n    const order =\n      column.order === givenOrder ? null : givenOrder || toggleOrder(column)\n\n    let target = event.target as HTMLElement\n    while (target && target.tagName !== 'TH') {\n      target = target.parentNode as HTMLElement\n    }\n\n    if (target && target.tagName === 'TH') {\n      if (hasClass(target, 'noclick')) {\n        removeClass(target, 'noclick')\n        return\n      }\n    }\n\n    if (!column.sortable) return\n\n    const states = props.store.states\n    let sortProp = states.sortProp.value\n    let sortOrder\n    const sortingColumn = states.sortingColumn.value\n\n    if (\n      sortingColumn !== column ||\n      (sortingColumn === column && sortingColumn.order === null)\n    ) {\n      if (sortingColumn) {\n        sortingColumn.order = null\n      }\n      states.sortingColumn.value = column\n      sortProp = column.property\n    }\n    if (!order) {\n      sortOrder = column.order = null\n    } else {\n      sortOrder = column.order = order\n    }\n\n    states.sortProp.value = sortProp\n    states.sortOrder.value = sortOrder\n\n    parent?.store.commit('changeSortCondition')\n  }\n\n  return {\n    handleHeaderClick,\n    handleHeaderContextMenu,\n    handleMouseDown,\n    handleMouseMove,\n    handleMouseOut,\n    handleSortClick,\n    handleFilterClick,\n  }\n}\n\nexport default useEvent\n"]},"metadata":{},"sourceType":"module"}