{"ast":null,"code":"import _toConsumableArray from \"C:/PartTimeJob/blog/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _objectSpread from \"C:/PartTimeJob/blog/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport { defineComponent, inject, ref, provide, computed, unref, onMounted, watch, openBlock, createElementBlock, normalizeStyle, normalizeClass, renderSlot } from 'vue';\nimport { createPopper } from '@popperjs/core';\nimport '../../../hooks/index.mjs';\nimport '../../../tokens/index.mjs';\nimport { usePopperContentProps } from './content.mjs';\nimport { unwrapMeasurableEl, buildPopperOptions } from './utils.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport { POPPER_INJECTION_KEY, POPPER_CONTENT_INJECTION_KEY } from '../../../tokens/popper.mjs';\nimport { useZIndex } from '../../../hooks/use-z-index/index.mjs';\nimport { useNamespace } from '../../../hooks/use-namespace/index.mjs';\nvar __default__ = {\n  name: \"ElPopperContent\"\n};\n\nvar _sfc_main = /* @__PURE__ */defineComponent(_objectSpread(_objectSpread({}, __default__), {}, {\n  props: usePopperContentProps,\n  emits: [\"mouseenter\", \"mouseleave\"],\n  setup: function setup(__props, _ref) {\n    var expose = _ref.expose;\n    var props = __props;\n\n    var _inject = inject(POPPER_INJECTION_KEY, void 0),\n        popperInstanceRef = _inject.popperInstanceRef,\n        contentRef = _inject.contentRef,\n        triggerRef = _inject.triggerRef;\n\n    var _useZIndex = useZIndex(),\n        nextZIndex = _useZIndex.nextZIndex;\n\n    var ns = useNamespace(\"popper\");\n    var popperContentRef = ref();\n    var arrowRef = ref();\n    var arrowOffset = ref();\n    provide(POPPER_CONTENT_INJECTION_KEY, {\n      arrowRef: arrowRef,\n      arrowOffset: arrowOffset\n    });\n    var contentZIndex = ref(props.zIndex || nextZIndex());\n    var computedReference = computed(function () {\n      return unwrapMeasurableEl(props.referenceEl) || unref(triggerRef);\n    });\n    var contentStyle = computed(function () {\n      return [{\n        zIndex: unref(contentZIndex)\n      }, props.popperStyle];\n    });\n    var contentClass = computed(function () {\n      return [ns.b(), ns.is(\"pure\", props.pure), ns.is(props.effect), props.popperClass];\n    });\n\n    var createPopperInstance = function createPopperInstance(_ref2) {\n      var referenceEl = _ref2.referenceEl,\n          popperContentEl = _ref2.popperContentEl,\n          arrowEl = _ref2.arrowEl;\n      var options = buildPopperOptions(props, {\n        arrowEl: arrowEl,\n        arrowOffset: unref(arrowOffset)\n      });\n      return createPopper(referenceEl, popperContentEl, options);\n    };\n\n    var updatePopper = function updatePopper() {\n      var _a;\n\n      (_a = unref(popperInstanceRef)) == null ? void 0 : _a.update();\n      contentZIndex.value = props.zIndex || contentZIndex.value || nextZIndex();\n    };\n\n    var togglePopperAlive = function togglePopperAlive() {\n      var _a, _b;\n\n      var monitorable = {\n        name: \"eventListeners\",\n        enabled: props.visible\n      };\n      (_b = (_a = unref(popperInstanceRef)) == null ? void 0 : _a.setOptions) == null ? void 0 : _b.call(_a, function (options) {\n        return _objectSpread(_objectSpread({}, options), {}, {\n          modifiers: [].concat(_toConsumableArray(options.modifiers || []), [monitorable])\n        });\n      });\n      updatePopper();\n    };\n\n    onMounted(function () {\n      var updateHandle;\n      watch(computedReference, function (referenceEl) {\n        var _a;\n\n        updateHandle == null ? void 0 : updateHandle();\n        var popperInstance = unref(popperInstanceRef);\n        (_a = popperInstance == null ? void 0 : popperInstance.destroy) == null ? void 0 : _a.call(popperInstance);\n\n        if (referenceEl) {\n          var popperContentEl = unref(popperContentRef);\n          contentRef.value = popperContentEl;\n          popperInstanceRef.value = createPopperInstance({\n            referenceEl: referenceEl,\n            popperContentEl: popperContentEl,\n            arrowEl: unref(arrowRef)\n          });\n          updateHandle = watch(function () {\n            return referenceEl.getBoundingClientRect();\n          }, function () {\n            return updatePopper();\n          }, {\n            immediate: true\n          });\n        } else {\n          popperInstanceRef.value = void 0;\n        }\n      }, {\n        immediate: true\n      });\n      watch(function () {\n        return props.visible;\n      }, togglePopperAlive, {\n        immediate: true\n      });\n      watch(function () {\n        return buildPopperOptions(props, {\n          arrowEl: unref(arrowRef),\n          arrowOffset: unref(arrowOffset)\n        });\n      }, function (option) {\n        var _a;\n\n        return (_a = popperInstanceRef.value) == null ? void 0 : _a.setOptions(option);\n      });\n    });\n    expose({\n      popperContentRef: popperContentRef,\n      popperInstanceRef: popperInstanceRef,\n      updatePopper: updatePopper,\n      contentStyle: contentStyle\n    });\n    return function (_ctx, _cache) {\n      return openBlock(), createElementBlock(\"div\", {\n        ref_key: \"popperContentRef\",\n        ref: popperContentRef,\n        style: normalizeStyle(unref(contentStyle)),\n        \"class\": normalizeClass(unref(contentClass)),\n        role: \"tooltip\",\n        onMouseenter: _cache[0] || (_cache[0] = function (e) {\n          return _ctx.$emit(\"mouseenter\", e);\n        }),\n        onMouseleave: _cache[1] || (_cache[1] = function (e) {\n          return _ctx.$emit(\"mouseleave\", e);\n        })\n      }, [renderSlot(_ctx.$slots, \"default\")], 38);\n    };\n  }\n}));\n\nvar ElPopperContent = /* @__PURE__ */_export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/popper/src/content.vue\"]]);\n\nexport { ElPopperContent as default };","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAkCA,yBACAA,oBADA,EAEA,KACA,CAHA;AAAA;AAAA;AAAA;;AAIA;AAAA;;AACA;AACA;AACA;AACA;AACAC;AACAC,wBADA;AAEAC;AAFA;AAIA;AAEA,qCACA;AAAA;AAAA,KADA;AAIA,gCACA;AAAA;AAAAC;AAAA;AAAA,KADA;AAIA;AAAA,cACAC,MADA,EAEAA,yBAFA,EAGAA,mBAHA,EAIAC,iBAJA;AAAA;;AAOA;AAAA;AAAA;AAAA;AACA;AACAC,wBADA;AAEAJ;AAFA;AAKA;AACA,KAPA;;AASA;AACA;;AACA;AACAK;AAEA,KALA;;AAMA;AACA;;AACA;AAAAC;AAAAC;AAAA;AAAA,uBACA,mBADA,KACA,IADA,GACA,MADA,GACAC,aADA,KACA,IADA,GACA,MADA,GACAC;AAAA,+CACAC,OADA;AAEAC;AAFA;AAAA,QADA;AAMAC;AACA,KATA;;AAWAC;AAEA;AACAC;AACA;;AACAC;AACA;AACA;;AAEA;AACA;AACAC;AACAC;AACAC,oCADA;AAGAC,4CAHA;AAOAf;AAPA;AAUAW;AAAA;AAAA;AAAA;AAAA;AACAK;AADA;AAIA,SAjBA,MAiBA;AACAH;AAEA;AAEA,OA5BA,EA4BA;AAGAG;AAHA,OA5BA;AAkCAN;AAAA;AAAA;AAAAM;AAAA;AACAN,WACA;AAAA;AAEAV,kCAFA;AAIAJ;AAJA;AAAA,SAQA;AAIA;;AAIA;AAKA,OArBA,CADA;AAuBA,KA7DA","names":["POPPER_INJECTION_KEY","provide","arrowRef","arrowOffset","zIndex","ns","props","arrowEl","contentZIndex","name","enabled","_a","_b","options","modifiers","updatePopper","onMounted","watch","updateHandle","contentRef","popperInstanceRef","referenceEl","popperContentEl","immediate"],"sources":["../../../../../../packages/components/popper/src/content.vue"],"sourcesContent":["<template>\n  <div\n    ref=\"popperContentRef\"\n    :style=\"contentStyle\"\n    :class=\"contentClass\"\n    role=\"tooltip\"\n    @mouseenter=\"(e) => $emit('mouseenter', e)\"\n    @mouseleave=\"(e) => $emit('mouseleave', e)\"\n  >\n    <slot />\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed, inject, onMounted, provide, ref, unref, watch } from 'vue'\nimport { createPopper } from '@popperjs/core'\nimport { useNamespace, useZIndex } from '@element-plus/hooks'\nimport {\n  POPPER_CONTENT_INJECTION_KEY,\n  POPPER_INJECTION_KEY,\n} from '@element-plus/tokens'\nimport { usePopperContentProps } from './content'\nimport { buildPopperOptions, unwrapMeasurableEl } from './utils'\n\nimport type { WatchStopHandle } from 'vue'\n\ndefineOptions({\n  name: 'ElPopperContent',\n})\n\ndefineEmits(['mouseenter', 'mouseleave'])\n\nconst props = defineProps(usePopperContentProps)\n\nconst { popperInstanceRef, contentRef, triggerRef } = inject(\n  POPPER_INJECTION_KEY,\n  undefined\n)!\nconst { nextZIndex } = useZIndex()\nconst ns = useNamespace('popper')\nconst popperContentRef = ref<HTMLElement>()\nconst arrowRef = ref<HTMLElement>()\nconst arrowOffset = ref<number>()\nprovide(POPPER_CONTENT_INJECTION_KEY, {\n  arrowRef,\n  arrowOffset,\n})\nconst contentZIndex = ref(props.zIndex || nextZIndex())\n\nconst computedReference = computed(\n  () => unwrapMeasurableEl(props.referenceEl) || unref(triggerRef)\n)\n\nconst contentStyle = computed(\n  () => [{ zIndex: unref(contentZIndex) }, props.popperStyle] as any\n)\n\nconst contentClass = computed(() => [\n  ns.b(),\n  ns.is('pure', props.pure),\n  ns.is(props.effect),\n  props.popperClass,\n])\n\nconst createPopperInstance = ({ referenceEl, popperContentEl, arrowEl }) => {\n  const options = buildPopperOptions(props, {\n    arrowEl,\n    arrowOffset: unref(arrowOffset),\n  })\n\n  return createPopper(referenceEl, popperContentEl, options)\n}\n\nconst updatePopper = () => {\n  unref(popperInstanceRef)?.update()\n  contentZIndex.value = props.zIndex || contentZIndex.value || nextZIndex()\n}\n\nconst togglePopperAlive = () => {\n  const monitorable = { name: 'eventListeners', enabled: props.visible }\n  unref(popperInstanceRef)?.setOptions?.((options) => ({\n    ...options,\n    modifiers: [...(options.modifiers || []), monitorable],\n  }))\n  updatePopper()\n}\n\nonMounted(() => {\n  let updateHandle: WatchStopHandle\n  watch(\n    computedReference,\n    (referenceEl) => {\n      updateHandle?.()\n      const popperInstance = unref(popperInstanceRef)\n      popperInstance?.destroy?.()\n      if (referenceEl) {\n        const popperContentEl = unref(popperContentRef)!\n        contentRef.value = popperContentEl\n\n        popperInstanceRef.value = createPopperInstance({\n          referenceEl,\n          popperContentEl,\n          arrowEl: unref(arrowRef),\n        })\n\n        updateHandle = watch(\n          () => referenceEl.getBoundingClientRect(),\n          () => updatePopper(),\n          {\n            immediate: true,\n          }\n        )\n      } else {\n        popperInstanceRef.value = undefined\n      }\n    },\n    {\n      immediate: true,\n    }\n  )\n\n  watch(() => props.visible, togglePopperAlive, { immediate: true })\n\n  watch(\n    () =>\n      buildPopperOptions(props, {\n        arrowEl: unref(arrowRef),\n        arrowOffset: unref(arrowOffset),\n      }),\n    (option) => popperInstanceRef.value?.setOptions(option)\n  )\n})\n\ndefineExpose({\n  /**\n   * @description popper content element\n   */\n  popperContentRef,\n  /**\n   * @description popperjs instance\n   */\n  popperInstanceRef,\n  /**\n   * @description method for updating popper\n   */\n  updatePopper,\n\n  /**\n   * @description content style\n   */\n  contentStyle,\n})\n</script>\n"]},"metadata":{},"sourceType":"module"}