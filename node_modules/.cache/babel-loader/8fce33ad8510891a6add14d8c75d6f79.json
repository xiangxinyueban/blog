{"ast":null,"code":"import \"core-js/modules/es.array.concat.js\";\nimport { onMounted, watchEffect, onBeforeUnmount } from 'vue';\nimport '../../utils/index.mjs';\nimport { addUnit } from '../../utils/vue/style.mjs';\n\nvar useDraggable = function useDraggable(targetRef, dragRef, draggable) {\n  var transform = {\n    offsetX: 0,\n    offsetY: 0\n  };\n\n  var onMousedown = function onMousedown(e) {\n    var downX = e.clientX;\n    var downY = e.clientY;\n    var _transform = transform,\n        offsetX = _transform.offsetX,\n        offsetY = _transform.offsetY;\n    var targetRect = targetRef.value.getBoundingClientRect();\n    var targetLeft = targetRect.left;\n    var targetTop = targetRect.top;\n    var targetWidth = targetRect.width;\n    var targetHeight = targetRect.height;\n    var clientWidth = document.documentElement.clientWidth;\n    var clientHeight = document.documentElement.clientHeight;\n    var minLeft = -targetLeft + offsetX;\n    var minTop = -targetTop + offsetY;\n    var maxLeft = clientWidth - targetLeft - targetWidth + offsetX;\n    var maxTop = clientHeight - targetTop - targetHeight + offsetY;\n\n    var onMousemove = function onMousemove(e2) {\n      var moveX = Math.min(Math.max(offsetX + e2.clientX - downX, minLeft), maxLeft);\n      var moveY = Math.min(Math.max(offsetY + e2.clientY - downY, minTop), maxTop);\n      transform = {\n        offsetX: moveX,\n        offsetY: moveY\n      };\n      targetRef.value.style.transform = \"translate(\".concat(addUnit(moveX), \", \").concat(addUnit(moveY), \")\");\n    };\n\n    var onMouseup = function onMouseup() {\n      document.removeEventListener(\"mousemove\", onMousemove);\n      document.removeEventListener(\"mouseup\", onMouseup);\n    };\n\n    document.addEventListener(\"mousemove\", onMousemove);\n    document.addEventListener(\"mouseup\", onMouseup);\n  };\n\n  var onDraggable = function onDraggable() {\n    if (dragRef.value && targetRef.value) {\n      dragRef.value.addEventListener(\"mousedown\", onMousedown);\n    }\n  };\n\n  var offDraggable = function offDraggable() {\n    if (dragRef.value && targetRef.value) {\n      dragRef.value.removeEventListener(\"mousedown\", onMousedown);\n    }\n  };\n\n  onMounted(function () {\n    watchEffect(function () {\n      if (draggable.value) {\n        onDraggable();\n      } else {\n        offDraggable();\n      }\n    });\n  });\n  onBeforeUnmount(function () {\n    offDraggable();\n  });\n};\n\nexport { useDraggable };","map":{"version":3,"mappings":";;;;;AAEY,IAACA,YAAY,GAAG,SAAfA,YAAe,CAACC,SAAD,EAAYC,OAAZ,EAAqBC,SAArB,EAAmC;AAC7D,MAAIC,SAAS,GAAG;AACdC,WAAO,EAAE,CADK;AAEdC,WAAO,EAAE;AAFK,GAAhB;;AAIA,MAAMC,WAAW,GAAG,SAAdA,WAAc,CAACC,CAAD,EAAO;AACzB,QAAMC,KAAK,GAAGD,CAAC,CAACE,OAAhB;AACA,QAAMC,KAAK,GAAGH,CAAC,CAACI,OAAhB;AACA,qBAA6BR,SAA7B;AAAA,QAAQC,OAAR,cAAQA,OAAR;AAAA,QAAiBC,OAAjB,cAAiBA,OAAjB;AACA,QAAMO,UAAU,GAAGZ,SAAS,CAACa,KAAV,CAAgBC,qBAAhB,EAAnB;AACA,QAAMC,UAAU,GAAGH,UAAU,CAACI,IAA9B;AACA,QAAMC,SAAS,GAAGL,UAAU,CAACM,GAA7B;AACA,QAAMC,WAAW,GAAGP,UAAU,CAACQ,KAA/B;AACA,QAAMC,YAAY,GAAGT,UAAU,CAACU,MAAhC;AACA,QAAMC,WAAW,GAAGC,QAAQ,CAACC,eAAT,CAAyBF,WAA7C;AACA,QAAMG,YAAY,GAAGF,QAAQ,CAACC,eAAT,CAAyBC,YAA9C;AACA,QAAMC,OAAO,GAAG,CAACZ,UAAD,GAAcX,OAA9B;AACA,QAAMwB,MAAM,GAAG,CAACX,SAAD,GAAaZ,OAA5B;AACA,QAAMwB,OAAO,GAAGN,WAAW,GAAGR,UAAd,GAA2BI,WAA3B,GAAyCf,OAAzD;AACA,QAAM0B,MAAM,GAAGJ,YAAY,GAAGT,SAAf,GAA2BI,YAA3B,GAA0ChB,OAAzD;;AACA,QAAM0B,WAAW,GAAG,SAAdA,WAAc,CAACC,EAAD,EAAQ;AAC1B,UAAMC,KAAK,GAAGC,IAAI,CAACC,GAAL,CAASD,IAAI,CAACE,GAAL,CAAShC,OAAO,GAAG4B,EAAE,CAACvB,OAAb,GAAuBD,KAAhC,EAAuCmB,OAAvC,CAAT,EAA0DE,OAA1D,CAAd;AACA,UAAMQ,KAAK,GAAGH,IAAI,CAACC,GAAL,CAASD,IAAI,CAACE,GAAL,CAAS/B,OAAO,GAAG2B,EAAE,CAACrB,OAAb,GAAuBD,KAAhC,EAAuCkB,MAAvC,CAAT,EAAyDE,MAAzD,CAAd;AACA3B,eAAS,GAAG;AACVC,eAAO,EAAE6B,KADC;AAEV5B,eAAO,EAAEgC;AAFC,OAAZ;AAIArC,eAAS,CAACa,KAAV,CAAgByB,KAAhB,CAAsBnC,SAAtB,uBAA+CoC,OAAO,CAACN,KAAD,CAAtD,eAAkEM,OAAO,CAACF,KAAD,CAAzE;AACD,KARD;;AASA,QAAMG,SAAS,GAAG,SAAZA,SAAY,GAAM;AACtBhB,cAAQ,CAACiB,mBAAT,CAA6B,WAA7B,EAA0CV,WAA1C;AACAP,cAAQ,CAACiB,mBAAT,CAA6B,SAA7B,EAAwCD,SAAxC;AACD,KAHD;;AAIAhB,YAAQ,CAACkB,gBAAT,CAA0B,WAA1B,EAAuCX,WAAvC;AACAP,YAAQ,CAACkB,gBAAT,CAA0B,SAA1B,EAAqCF,SAArC;AACD,GA9BD;;AA+BA,MAAMG,WAAW,GAAG,SAAdA,WAAc,GAAM;AACxB,QAAI1C,OAAO,CAACY,KAAR,IAAiBb,SAAS,CAACa,KAA/B,EAAsC;AACpCZ,aAAO,CAACY,KAAR,CAAc6B,gBAAd,CAA+B,WAA/B,EAA4CpC,WAA5C;AACD;AACF,GAJD;;AAKA,MAAMsC,YAAY,GAAG,SAAfA,YAAe,GAAM;AACzB,QAAI3C,OAAO,CAACY,KAAR,IAAiBb,SAAS,CAACa,KAA/B,EAAsC;AACpCZ,aAAO,CAACY,KAAR,CAAc4B,mBAAd,CAAkC,WAAlC,EAA+CnC,WAA/C;AACD;AACF,GAJD;;AAKAuC,WAAS,CAAC,YAAM;AACdC,eAAW,CAAC,YAAM;AAChB,UAAI5C,SAAS,CAACW,KAAd,EAAqB;AACnB8B,mBAAW;AACZ,OAFD,MAEO;AACLC,oBAAY;AACb;AACF,KANU,CAAX;AAOD,GARQ,CAAT;AASAG,iBAAe,CAAC,YAAM;AACpBH,gBAAY;AACb,GAFc,CAAf;AAGF,CA1DY","names":["useDraggable","targetRef","dragRef","draggable","transform","offsetX","offsetY","onMousedown","e","downX","clientX","downY","clientY","targetRect","value","getBoundingClientRect","targetLeft","left","targetTop","top","targetWidth","width","targetHeight","height","clientWidth","document","documentElement","clientHeight","minLeft","minTop","maxLeft","maxTop","onMousemove","e2","moveX","Math","min","max","moveY","style","addUnit","onMouseup","removeEventListener","addEventListener","onDraggable","offDraggable","onMounted","watchEffect","onBeforeUnmount"],"sources":["../../../../../packages/hooks/use-draggable/index.ts"],"sourcesContent":["import { onBeforeUnmount, onMounted, watchEffect } from 'vue'\nimport { addUnit } from '@element-plus/utils'\nimport type { ComputedRef, Ref } from 'vue'\n\nexport const useDraggable = (\n  targetRef: Ref<HTMLElement | undefined>,\n  dragRef: Ref<HTMLElement | undefined>,\n  draggable: ComputedRef<boolean>\n) => {\n  let transform = {\n    offsetX: 0,\n    offsetY: 0,\n  }\n\n  const onMousedown = (e: MouseEvent) => {\n    const downX = e.clientX\n    const downY = e.clientY\n    const { offsetX, offsetY } = transform\n\n    const targetRect = targetRef.value!.getBoundingClientRect()\n    const targetLeft = targetRect.left\n    const targetTop = targetRect.top\n    const targetWidth = targetRect.width\n    const targetHeight = targetRect.height\n\n    const clientWidth = document.documentElement.clientWidth\n    const clientHeight = document.documentElement.clientHeight\n\n    const minLeft = -targetLeft + offsetX\n    const minTop = -targetTop + offsetY\n    const maxLeft = clientWidth - targetLeft - targetWidth + offsetX\n    const maxTop = clientHeight - targetTop - targetHeight + offsetY\n\n    const onMousemove = (e: MouseEvent) => {\n      const moveX = Math.min(\n        Math.max(offsetX + e.clientX - downX, minLeft),\n        maxLeft\n      )\n      const moveY = Math.min(\n        Math.max(offsetY + e.clientY - downY, minTop),\n        maxTop\n      )\n\n      transform = {\n        offsetX: moveX,\n        offsetY: moveY,\n      }\n      targetRef.value!.style.transform = `translate(${addUnit(\n        moveX\n      )}, ${addUnit(moveY)})`\n    }\n\n    const onMouseup = () => {\n      document.removeEventListener('mousemove', onMousemove)\n      document.removeEventListener('mouseup', onMouseup)\n    }\n\n    document.addEventListener('mousemove', onMousemove)\n    document.addEventListener('mouseup', onMouseup)\n  }\n\n  const onDraggable = () => {\n    if (dragRef.value && targetRef.value) {\n      dragRef.value.addEventListener('mousedown', onMousedown)\n    }\n  }\n\n  const offDraggable = () => {\n    if (dragRef.value && targetRef.value) {\n      dragRef.value.removeEventListener('mousedown', onMousedown)\n    }\n  }\n\n  onMounted(() => {\n    watchEffect(() => {\n      if (draggable.value) {\n        onDraggable()\n      } else {\n        offDraggable()\n      }\n    })\n  })\n\n  onBeforeUnmount(() => {\n    offDraggable()\n  })\n}\n"]},"metadata":{},"sourceType":"module"}