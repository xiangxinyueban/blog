{"ast":null,"code":"import _objectSpread from \"C:/PartTimeJob/blog/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.number.parse-int.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.error.to-string.js\";\nimport \"core-js/modules/es.date.to-string.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.to-string.js\";\nimport \"core-js/modules/web.timers.js\";\nimport { ref, reactive, h, Transition, withCtx, withDirectives, createVNode, vShow, createApp, toRefs } from 'vue';\nimport '../../../utils/index.mjs';\nimport { removeClass } from '../../../utils/dom/style.mjs';\n\nfunction createLoadingComponent(options) {\n  var afterLeaveTimer;\n  var afterLeaveFlag = ref(false);\n  var data = reactive(_objectSpread(_objectSpread({}, options), {}, {\n    originalPosition: \"\",\n    originalOverflow: \"\",\n    visible: false\n  }));\n\n  function setText(text) {\n    data.text = text;\n  }\n\n  function destroySelf() {\n    var target = data.parent;\n\n    if (!target.vLoadingAddClassList) {\n      var loadingNumber = target.getAttribute(\"loading-number\");\n      loadingNumber = Number.parseInt(loadingNumber) - 1;\n\n      if (!loadingNumber) {\n        removeClass(target, \"el-loading-parent--relative\");\n        target.removeAttribute(\"loading-number\");\n      } else {\n        target.setAttribute(\"loading-number\", loadingNumber.toString());\n      }\n\n      removeClass(target, \"el-loading-parent--hidden\");\n    }\n\n    remvoeElLoadingChild();\n  }\n\n  function remvoeElLoadingChild() {\n    var _a, _b;\n\n    (_b = (_a = vm.$el) == null ? void 0 : _a.parentNode) == null ? void 0 : _b.removeChild(vm.$el);\n  }\n\n  function close() {\n    var _a;\n\n    if (options.beforeClose && !options.beforeClose()) return;\n    var target = data.parent;\n    target.vLoadingAddClassList = void 0;\n    afterLeaveFlag.value = true;\n    clearTimeout(afterLeaveTimer);\n    afterLeaveTimer = window.setTimeout(function () {\n      if (afterLeaveFlag.value) {\n        afterLeaveFlag.value = false;\n        destroySelf();\n      }\n    }, 400);\n    data.visible = false;\n    (_a = options.closed) == null ? void 0 : _a.call(options);\n  }\n\n  function handleAfterLeave() {\n    if (!afterLeaveFlag.value) return;\n    afterLeaveFlag.value = false;\n    destroySelf();\n  }\n\n  var elLoadingComponent = {\n    name: \"ElLoading\",\n    setup: function setup() {\n      return function () {\n        var svg = data.spinner || data.svg;\n        var spinner = h(\"svg\", _objectSpread({\n          \"class\": \"circular\",\n          viewBox: data.svgViewBox ? data.svgViewBox : \"25 25 50 50\"\n        }, svg ? {\n          innerHTML: svg\n        } : {}), [h(\"circle\", {\n          \"class\": \"path\",\n          cx: \"50\",\n          cy: \"50\",\n          r: \"20\",\n          fill: \"none\"\n        })]);\n        var spinnerText = data.text ? h(\"p\", {\n          \"class\": \"el-loading-text\"\n        }, [data.text]) : void 0;\n        return h(Transition, {\n          name: \"el-loading-fade\",\n          onAfterLeave: handleAfterLeave\n        }, {\n          \"default\": withCtx(function () {\n            return [withDirectives(createVNode(\"div\", {\n              style: {\n                backgroundColor: data.background || \"\"\n              },\n              \"class\": [\"el-loading-mask\", data.customClass, data.fullscreen ? \"is-fullscreen\" : \"\"]\n            }, [h(\"div\", {\n              \"class\": \"el-loading-spinner\"\n            }, [spinner, spinnerText])]), [[vShow, data.visible]])];\n          })\n        });\n      };\n    }\n  };\n  var vm = createApp(elLoadingComponent).mount(document.createElement(\"div\"));\n  return _objectSpread(_objectSpread({}, toRefs(data)), {}, {\n    setText: setText,\n    remvoeElLoadingChild: remvoeElLoadingChild,\n    close: close,\n    handleAfterLeave: handleAfterLeave,\n    vm: vm,\n\n    get $el() {\n      return vm.$el;\n    }\n\n  });\n}\n\nexport { createLoadingComponent };","map":{"version":3,"mappings":"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","names":["createLoadingComponent","options","afterLeaveTimer","afterLeaveFlag","ref","data","reactive","originalPosition","originalOverflow","visible","setText","text","destroySelf","target","parent","vLoadingAddClassList","loadingNumber","getAttribute","Number","parseInt","removeClass","removeAttribute","setAttribute","toString","remvoeElLoadingChild","_a","_b","vm","$el","parentNode","removeChild","close","beforeClose","value","clearTimeout","window","setTimeout","closed","call","handleAfterLeave","elLoadingComponent","name","setup","svg","spinner","h","viewBox","svgViewBox","innerHTML","cx","cy","r","fill","spinnerText","Transition","onAfterLeave","withCtx","withDirectives","createVNode","style","backgroundColor","background","customClass","fullscreen","vShow","createApp","mount","document","createElement","toRefs"],"sources":["../../../../../../packages/components/loading/src/loading.ts"],"sourcesContent":["import {\n  Transition,\n  createApp,\n  createVNode,\n  h,\n  reactive,\n  ref,\n  toRefs,\n  vShow,\n  withCtx,\n  withDirectives,\n} from 'vue'\nimport { removeClass } from '@element-plus/utils'\n\nimport type { LoadingOptionsResolved } from './types'\n\nexport function createLoadingComponent(options: LoadingOptionsResolved) {\n  let afterLeaveTimer: number\n\n  const afterLeaveFlag = ref(false)\n  const data = reactive({\n    ...options,\n    originalPosition: '',\n    originalOverflow: '',\n    visible: false,\n  })\n\n  function setText(text: string) {\n    data.text = text\n  }\n\n  function destroySelf() {\n    const target = data.parent\n    if (!target.vLoadingAddClassList) {\n      let loadingNumber: number | string | null =\n        target.getAttribute('loading-number')\n      loadingNumber = Number.parseInt(loadingNumber as any) - 1\n      if (!loadingNumber) {\n        removeClass(target, 'el-loading-parent--relative')\n        target.removeAttribute('loading-number')\n      } else {\n        target.setAttribute('loading-number', loadingNumber.toString())\n      }\n      removeClass(target, 'el-loading-parent--hidden')\n    }\n    remvoeElLoadingChild()\n  }\n  function remvoeElLoadingChild(): void {\n    vm.$el?.parentNode?.removeChild(vm.$el)\n  }\n  function close() {\n    if (options.beforeClose && !options.beforeClose()) return\n\n    const target = data.parent\n    target.vLoadingAddClassList = undefined\n    afterLeaveFlag.value = true\n    clearTimeout(afterLeaveTimer)\n\n    afterLeaveTimer = window.setTimeout(() => {\n      if (afterLeaveFlag.value) {\n        afterLeaveFlag.value = false\n        destroySelf()\n      }\n    }, 400)\n    data.visible = false\n\n    options.closed?.()\n  }\n\n  function handleAfterLeave() {\n    if (!afterLeaveFlag.value) return\n    afterLeaveFlag.value = false\n    destroySelf()\n  }\n\n  const elLoadingComponent = {\n    name: 'ElLoading',\n    setup() {\n      return () => {\n        const svg = data.spinner || data.svg\n        const spinner = h(\n          'svg',\n          {\n            class: 'circular',\n            viewBox: data.svgViewBox ? data.svgViewBox : '25 25 50 50',\n            ...(svg ? { innerHTML: svg } : {}),\n          },\n          [\n            h('circle', {\n              class: 'path',\n              cx: '50',\n              cy: '50',\n              r: '20',\n              fill: 'none',\n            }),\n          ]\n        )\n\n        const spinnerText = data.text\n          ? h('p', { class: 'el-loading-text' }, [data.text])\n          : undefined\n\n        return h(\n          Transition,\n          {\n            name: 'el-loading-fade',\n            onAfterLeave: handleAfterLeave,\n          },\n          {\n            default: withCtx(() => [\n              withDirectives(\n                createVNode(\n                  'div',\n                  {\n                    style: {\n                      backgroundColor: data.background || '',\n                    },\n                    class: [\n                      'el-loading-mask',\n                      data.customClass,\n                      data.fullscreen ? 'is-fullscreen' : '',\n                    ],\n                  },\n                  [\n                    h(\n                      'div',\n                      {\n                        class: 'el-loading-spinner',\n                      },\n                      [spinner, spinnerText]\n                    ),\n                  ]\n                ),\n                [[vShow, data.visible]]\n              ),\n            ]),\n          }\n        )\n      }\n    },\n  }\n\n  const vm = createApp(elLoadingComponent).mount(document.createElement('div'))\n\n  return {\n    ...toRefs(data),\n    setText,\n    remvoeElLoadingChild,\n    close,\n    handleAfterLeave,\n    vm,\n    get $el(): HTMLElement {\n      return vm.$el\n    },\n  }\n}\n\nexport type LoadingInstance = ReturnType<typeof createLoadingComponent>\n"]},"metadata":{},"sourceType":"module"}