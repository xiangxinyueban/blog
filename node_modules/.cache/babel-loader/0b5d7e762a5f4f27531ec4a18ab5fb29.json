{"ast":null,"code":"import \"core-js/modules/es.number.is-nan.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.number.to-fixed.js\";\nimport \"core-js/modules/es.number.parse-float.js\";\nimport \"core-js/modules/es.error.to-string.js\";\nimport \"core-js/modules/es.date.to-string.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.to-string.js\";\nimport \"core-js/modules/es.array.index-of.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport { defineComponent, ref, reactive, computed, watch, onMounted, onUpdated, resolveComponent, resolveDirective, openBlock, createElementBlock, normalizeClass, withModifiers, withDirectives, withKeys, createVNode, withCtx, createBlock, createCommentVNode } from 'vue';\nimport { ElIcon } from '../../icon/index.mjs';\nimport '../../../directives/index.mjs';\nimport '../../../hooks/index.mjs';\nimport { ElInput } from '../../input/index.mjs';\nimport '../../../utils/index.mjs';\nimport { ArrowUp, ArrowDown, Plus, Minus } from '@element-plus/icons-vue';\nimport { inputNumberProps, inputNumberEmits } from './input-number.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport RepeatClick from '../../../directives/repeat-click/index.mjs';\nimport { useFormItem } from '../../../hooks/use-form-item/index.mjs';\nimport { useNamespace } from '../../../hooks/use-namespace/index.mjs';\nimport { isUndefined } from '../../../utils/types.mjs';\nimport { debugWarn } from '../../../utils/error.mjs';\nimport { useSize, useDisabled } from '../../../hooks/use-common-props/index.mjs';\nimport { isNumber } from '@vueuse/core';\n\nvar _sfc_main = defineComponent({\n  name: \"ElInputNumber\",\n  components: {\n    ElInput: ElInput,\n    ElIcon: ElIcon,\n    ArrowUp: ArrowUp,\n    ArrowDown: ArrowDown,\n    Plus: Plus,\n    Minus: Minus\n  },\n  directives: {\n    RepeatClick: RepeatClick\n  },\n  props: inputNumberProps,\n  emits: inputNumberEmits,\n  setup: function setup(props, _ref) {\n    var emit = _ref.emit;\n    var input = ref();\n    var data = reactive({\n      currentValue: props.modelValue,\n      userInput: null\n    });\n\n    var _useFormItem = useFormItem(),\n        formItem = _useFormItem.formItem;\n\n    var ns = useNamespace(\"input-number\");\n    var minDisabled = computed(function () {\n      return ensurePrecision(props.modelValue, -1) < props.min;\n    });\n    var maxDisabled = computed(function () {\n      return ensurePrecision(props.modelValue) > props.max;\n    });\n    var numPrecision = computed(function () {\n      var stepPrecision = getPrecision(props.step);\n\n      if (!isUndefined(props.precision)) {\n        if (stepPrecision > props.precision) {\n          debugWarn(\"InputNumber\", \"precision should not be less than the decimal places of step\");\n        }\n\n        return props.precision;\n      } else {\n        return Math.max(getPrecision(props.modelValue), stepPrecision);\n      }\n    });\n    var controlsAtRight = computed(function () {\n      return props.controls && props.controlsPosition === \"right\";\n    });\n    var inputNumberSize = useSize();\n    var inputNumberDisabled = useDisabled();\n    var displayValue = computed(function () {\n      if (data.userInput !== null) {\n        return data.userInput;\n      }\n\n      var currentValue = data.currentValue;\n\n      if (isNumber(currentValue)) {\n        if (Number.isNaN(currentValue)) return \"\";\n\n        if (!isUndefined(props.precision)) {\n          currentValue = currentValue.toFixed(props.precision);\n        }\n      }\n\n      return currentValue;\n    });\n\n    var toPrecision = function toPrecision(num, pre) {\n      if (isUndefined(pre)) pre = numPrecision.value;\n      return Number.parseFloat(\"\".concat(Math.round(num * Math.pow(10, pre)) / Math.pow(10, pre)));\n    };\n\n    var getPrecision = function getPrecision(value) {\n      if (isUndefined(value)) return 0;\n      var valueString = value.toString();\n      var dotPosition = valueString.indexOf(\".\");\n      var precision = 0;\n\n      if (dotPosition !== -1) {\n        precision = valueString.length - dotPosition - 1;\n      }\n\n      return precision;\n    };\n\n    var ensurePrecision = function ensurePrecision(val) {\n      var coefficient = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n      if (!isNumber(val)) return data.currentValue;\n      val = isNumber(val) ? val : Number.NaN;\n      return toPrecision(val + props.step * coefficient);\n    };\n\n    var increase = function increase() {\n      if (inputNumberDisabled.value || maxDisabled.value) return;\n      var value = props.modelValue || 0;\n      var newVal = ensurePrecision(value);\n      setCurrentValue(newVal);\n    };\n\n    var decrease = function decrease() {\n      if (inputNumberDisabled.value || minDisabled.value) return;\n      var value = props.modelValue || 0;\n      var newVal = ensurePrecision(value, -1);\n      setCurrentValue(newVal);\n    };\n\n    var verifyValue = function verifyValue(value, update) {\n      var max = props.max,\n          min = props.min,\n          step = props.step,\n          precision = props.precision,\n          stepStrictly = props.stepStrictly;\n      var newVal = Number(value);\n\n      if (value === null) {\n        newVal = Number.NaN;\n      }\n\n      if (!Number.isNaN(newVal)) {\n        if (stepStrictly) {\n          newVal = Math.round(newVal / step) * step;\n        }\n\n        if (!isUndefined(precision)) {\n          newVal = toPrecision(newVal, precision);\n        }\n\n        if (newVal > max || newVal < min) {\n          newVal = newVal > max ? max : min;\n          update && emit(\"update:modelValue\", newVal);\n        }\n      }\n\n      return newVal;\n    };\n\n    var setCurrentValue = function setCurrentValue(value) {\n      var _a;\n\n      var oldVal = data.currentValue;\n      var newVal = verifyValue(value);\n      if (oldVal === newVal) return;\n\n      if (Number.isNaN(newVal)) {\n        newVal = void 0;\n      }\n\n      data.userInput = null;\n      emit(\"update:modelValue\", newVal);\n      emit(\"input\", newVal);\n      emit(\"change\", newVal, oldVal);\n      (_a = formItem == null ? void 0 : formItem.validate) == null ? void 0 : _a.call(formItem, \"change\")[\"catch\"](function (err) {\n        return debugWarn(err);\n      });\n      data.currentValue = newVal;\n    };\n\n    var handleInput = function handleInput(value) {\n      return data.userInput = value;\n    };\n\n    var handleInputChange = function handleInputChange(value) {\n      var newVal = value !== \"\" ? Number(value) : \"\";\n\n      if (isNumber(newVal) && !Number.isNaN(newVal) || value === \"\") {\n        setCurrentValue(newVal);\n      }\n\n      data.userInput = null;\n    };\n\n    var focus = function focus() {\n      var _a, _b;\n\n      (_b = (_a = input.value) == null ? void 0 : _a.focus) == null ? void 0 : _b.call(_a);\n    };\n\n    var blur = function blur() {\n      var _a, _b;\n\n      (_b = (_a = input.value) == null ? void 0 : _a.blur) == null ? void 0 : _b.call(_a);\n    };\n\n    var handleFocus = function handleFocus(event) {\n      emit(\"focus\", event);\n    };\n\n    var handleBlur = function handleBlur(event) {\n      var _a;\n\n      emit(\"blur\", event);\n      (_a = formItem == null ? void 0 : formItem.validate) == null ? void 0 : _a.call(formItem, \"blur\")[\"catch\"](function (err) {\n        return debugWarn(err);\n      });\n    };\n\n    watch(function () {\n      return props.modelValue;\n    }, function (value) {\n      var newVal = verifyValue(value, true);\n      data.currentValue = newVal;\n      data.userInput = null;\n    }, {\n      immediate: true\n    });\n    onMounted(function () {\n      var _a;\n\n      var innerInput = (_a = input.value) == null ? void 0 : _a.input;\n      innerInput.setAttribute(\"role\", \"spinbutton\");\n      innerInput.setAttribute(\"aria-valuemax\", String(props.max));\n      innerInput.setAttribute(\"aria-valuemin\", String(props.min));\n      innerInput.setAttribute(\"aria-valuenow\", String(data.currentValue));\n      innerInput.setAttribute(\"aria-disabled\", String(inputNumberDisabled.value));\n\n      if (!isNumber(props.modelValue)) {\n        var val = Number(props.modelValue);\n\n        if (Number.isNaN(val)) {\n          val = void 0;\n        }\n\n        emit(\"update:modelValue\", val);\n      }\n    });\n    onUpdated(function () {\n      var _a;\n\n      var innerInput = (_a = input.value) == null ? void 0 : _a.input;\n      innerInput == null ? void 0 : innerInput.setAttribute(\"aria-valuenow\", data.currentValue);\n    });\n    return {\n      input: input,\n      displayValue: displayValue,\n      handleInput: handleInput,\n      handleInputChange: handleInputChange,\n      controlsAtRight: controlsAtRight,\n      decrease: decrease,\n      increase: increase,\n      inputNumberSize: inputNumberSize,\n      inputNumberDisabled: inputNumberDisabled,\n      maxDisabled: maxDisabled,\n      minDisabled: minDisabled,\n      focus: focus,\n      blur: blur,\n      handleFocus: handleFocus,\n      handleBlur: handleBlur,\n      ns: ns\n    };\n  }\n});\n\nfunction _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_arrow_down = resolveComponent(\"arrow-down\");\n\n  var _component_minus = resolveComponent(\"minus\");\n\n  var _component_el_icon = resolveComponent(\"el-icon\");\n\n  var _component_arrow_up = resolveComponent(\"arrow-up\");\n\n  var _component_plus = resolveComponent(\"plus\");\n\n  var _component_el_input = resolveComponent(\"el-input\");\n\n  var _directive_repeat_click = resolveDirective(\"repeat-click\");\n\n  return openBlock(), createElementBlock(\"div\", {\n    \"class\": normalizeClass([_ctx.ns.b(), _ctx.ns.m(_ctx.inputNumberSize), _ctx.ns.is(\"disabled\", _ctx.inputNumberDisabled), _ctx.ns.is(\"without-controls\", !_ctx.controls), _ctx.ns.is(\"controls-right\", _ctx.controlsAtRight)]),\n    onDragstart: _cache[2] || (_cache[2] = withModifiers(function () {}, [\"prevent\"]))\n  }, [_ctx.controls ? withDirectives((openBlock(), createElementBlock(\"span\", {\n    key: 0,\n    role: \"button\",\n    \"class\": normalizeClass([_ctx.ns.e(\"decrease\"), _ctx.ns.is(\"disabled\", _ctx.minDisabled)]),\n    onKeydown: _cache[0] || (_cache[0] = withKeys(function () {\n      return _ctx.decrease && _ctx.decrease.apply(_ctx, arguments);\n    }, [\"enter\"]))\n  }, [createVNode(_component_el_icon, null, {\n    \"default\": withCtx(function () {\n      return [_ctx.controlsAtRight ? (openBlock(), createBlock(_component_arrow_down, {\n        key: 0\n      })) : (openBlock(), createBlock(_component_minus, {\n        key: 1\n      }))];\n    }),\n    _: 1\n  })], 34)), [[_directive_repeat_click, _ctx.decrease]]) : createCommentVNode(\"v-if\", true), _ctx.controls ? withDirectives((openBlock(), createElementBlock(\"span\", {\n    key: 1,\n    role: \"button\",\n    \"class\": normalizeClass([_ctx.ns.e(\"increase\"), _ctx.ns.is(\"disabled\", _ctx.maxDisabled)]),\n    onKeydown: _cache[1] || (_cache[1] = withKeys(function () {\n      return _ctx.increase && _ctx.increase.apply(_ctx, arguments);\n    }, [\"enter\"]))\n  }, [createVNode(_component_el_icon, null, {\n    \"default\": withCtx(function () {\n      return [_ctx.controlsAtRight ? (openBlock(), createBlock(_component_arrow_up, {\n        key: 0\n      })) : (openBlock(), createBlock(_component_plus, {\n        key: 1\n      }))];\n    }),\n    _: 1\n  })], 34)), [[_directive_repeat_click, _ctx.increase]]) : createCommentVNode(\"v-if\", true), createVNode(_component_el_input, {\n    ref: \"input\",\n    type: \"number\",\n    step: _ctx.step,\n    \"model-value\": _ctx.displayValue,\n    placeholder: _ctx.placeholder,\n    disabled: _ctx.inputNumberDisabled,\n    size: _ctx.inputNumberSize,\n    max: _ctx.max,\n    min: _ctx.min,\n    name: _ctx.name,\n    label: _ctx.label,\n    \"validate-event\": false,\n    onKeydown: [withKeys(withModifiers(_ctx.increase, [\"prevent\"]), [\"up\"]), withKeys(withModifiers(_ctx.decrease, [\"prevent\"]), [\"down\"])],\n    onBlur: _ctx.handleBlur,\n    onFocus: _ctx.handleFocus,\n    onInput: _ctx.handleInput,\n    onChange: _ctx.handleInputChange\n  }, null, 8, [\"step\", \"model-value\", \"placeholder\", \"disabled\", \"size\", \"max\", \"min\", \"name\", \"label\", \"onKeydown\", \"onBlur\", \"onFocus\", \"onInput\", \"onChange\"])], 34);\n}\n\nvar InputNumber = /* @__PURE__ */_export_sfc(_sfc_main, [[\"render\", _sfc_render], [\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/input-number/src/input-number.vue\"]]);\n\nexport { InputNumber as default };","map":{"version":3,"mappings":"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","names":["_sfc_main","defineComponent","name","components","ElInput","ElIcon","ArrowUp","ArrowDown","Plus","Minus","directives","RepeatClick","props","emits","setup","emit","input","ref","data","reactive","currentValue","userInput","useFormItem","formItem","useNamespace","computed","ensurePrecision","modelValue","min","max","getPrecision","step","isUndefined","precision","debugWarn","Math","stepPrecision","controls","controlsPosition","inputNumberSize","useSize","inputNumberDisabled","useDisabled","isNaN","toFixed","toPrecision","num","pre","numPrecision","parseFloat","value","toString","valueString","dotPosition","length","val","coefficient","isNumber","Number","increase","maxDisabled","setCurrentValue","newVal","decrease","minDisabled","verifyValue","update","stepStrictly","oldVal","_a","handleInput","handleInputChange","_b","handleFocus","event","watch","immediate","onMounted","innerInput","String","onUpdated","displayValue","controlsAtRight","focus","blur","_component_el_icon","_resolveComponent","_ctx","onDragstart","_cache","withModifiers","key","role","_","_createCommentVNode","_directive_repeat_click","_createVNode","type","placeholder","disabled","size","label","onKeydown","_withKeys"],"sources":["../../../../../../packages/components/input-number/src/input-number.vue"],"sourcesContent":["<template>\n  <div\n    :class=\"[\n      ns.b(),\n      ns.m(inputNumberSize),\n      ns.is('disabled', inputNumberDisabled),\n      ns.is('without-controls', !controls),\n      ns.is('controls-right', controlsAtRight),\n    ]\"\n    @dragstart.prevent\n  >\n    <span\n      v-if=\"controls\"\n      v-repeat-click=\"decrease\"\n      role=\"button\"\n      :class=\"[ns.e('decrease'), ns.is('disabled', minDisabled)]\"\n      @keydown.enter=\"decrease\"\n    >\n      <el-icon>\n        <arrow-down v-if=\"controlsAtRight\" />\n        <minus v-else />\n      </el-icon>\n    </span>\n    <span\n      v-if=\"controls\"\n      v-repeat-click=\"increase\"\n      role=\"button\"\n      :class=\"[ns.e('increase'), ns.is('disabled', maxDisabled)]\"\n      @keydown.enter=\"increase\"\n    >\n      <el-icon>\n        <arrow-up v-if=\"controlsAtRight\" />\n        <plus v-else />\n      </el-icon>\n    </span>\n    <el-input\n      ref=\"input\"\n      type=\"number\"\n      :step=\"step\"\n      :model-value=\"displayValue\"\n      :placeholder=\"placeholder\"\n      :disabled=\"inputNumberDisabled\"\n      :size=\"inputNumberSize\"\n      :max=\"max\"\n      :min=\"min\"\n      :name=\"name\"\n      :label=\"label\"\n      :validate-event=\"false\"\n      @keydown.up.prevent=\"increase\"\n      @keydown.down.prevent=\"decrease\"\n      @blur=\"handleBlur\"\n      @focus=\"handleFocus\"\n      @input=\"handleInput\"\n      @change=\"handleInputChange\"\n    />\n  </div>\n</template>\n<script lang=\"ts\">\nimport {\n  computed,\n  defineComponent,\n  onMounted,\n  onUpdated,\n  reactive,\n  ref,\n  watch,\n} from 'vue'\n\nimport { ElIcon } from '@element-plus/components/icon'\nimport { RepeatClick } from '@element-plus/directives'\nimport {\n  useDisabled,\n  useFormItem,\n  useNamespace,\n  useSize,\n} from '@element-plus/hooks'\nimport ElInput from '@element-plus/components/input'\nimport { debugWarn, isNumber, isUndefined } from '@element-plus/utils'\nimport { ArrowDown, ArrowUp, Minus, Plus } from '@element-plus/icons-vue'\nimport { inputNumberEmits, inputNumberProps } from './input-number'\n\nimport type { ComponentPublicInstance } from 'vue'\n\ninterface IData {\n  currentValue: number | undefined\n  userInput: null | number | string\n}\n\nexport default defineComponent({\n  name: 'ElInputNumber',\n  components: {\n    ElInput,\n    ElIcon,\n    ArrowUp,\n    ArrowDown,\n    Plus,\n    Minus,\n  },\n  directives: {\n    RepeatClick,\n  },\n  props: inputNumberProps,\n  emits: inputNumberEmits,\n  setup(props, { emit }) {\n    const input = ref<ComponentPublicInstance<typeof ElInput>>()\n    const data = reactive<IData>({\n      currentValue: props.modelValue,\n      userInput: null,\n    })\n    const { formItem } = useFormItem()\n    const ns = useNamespace('input-number')\n\n    const minDisabled = computed(\n      () => ensurePrecision(props.modelValue, -1) < props.min\n    )\n    const maxDisabled = computed(\n      () => ensurePrecision(props.modelValue) > props.max\n    )\n\n    const numPrecision = computed(() => {\n      const stepPrecision = getPrecision(props.step)\n      if (!isUndefined(props.precision)) {\n        if (stepPrecision > props.precision) {\n          debugWarn(\n            'InputNumber',\n            'precision should not be less than the decimal places of step'\n          )\n        }\n        return props.precision\n      } else {\n        return Math.max(getPrecision(props.modelValue), stepPrecision)\n      }\n    })\n    const controlsAtRight = computed(() => {\n      return props.controls && props.controlsPosition === 'right'\n    })\n\n    const inputNumberSize = useSize()\n    const inputNumberDisabled = useDisabled()\n\n    const displayValue = computed(() => {\n      if (data.userInput !== null) {\n        return data.userInput\n      }\n      let currentValue: number | string | undefined = data.currentValue\n      if (isNumber(currentValue)) {\n        if (Number.isNaN(currentValue)) return ''\n        if (!isUndefined(props.precision)) {\n          currentValue = currentValue.toFixed(props.precision)\n        }\n      }\n      return currentValue\n    })\n    const toPrecision = (num: number, pre?: number) => {\n      if (isUndefined(pre)) pre = numPrecision.value\n      return Number.parseFloat(`${Math.round(num * 10 ** pre) / 10 ** pre}`)\n    }\n    const getPrecision = (value: number | undefined) => {\n      if (isUndefined(value)) return 0\n      const valueString = value.toString()\n      const dotPosition = valueString.indexOf('.')\n      let precision = 0\n      if (dotPosition !== -1) {\n        precision = valueString.length - dotPosition - 1\n      }\n      return precision\n    }\n    const ensurePrecision = (val: number, coefficient: 1 | -1 = 1) => {\n      if (!isNumber(val)) return data.currentValue\n      // Solve the accuracy problem of JS decimal calculation by converting the value to integer.\n      val = isNumber(val) ? val : Number.NaN\n      return toPrecision(val + props.step * coefficient)\n    }\n    const increase = () => {\n      if (inputNumberDisabled.value || maxDisabled.value) return\n      const value = props.modelValue || 0\n      const newVal = ensurePrecision(value)\n      setCurrentValue(newVal)\n    }\n    const decrease = () => {\n      if (inputNumberDisabled.value || minDisabled.value) return\n      const value = props.modelValue || 0\n      const newVal = ensurePrecision(value, -1)\n      setCurrentValue(newVal)\n    }\n    const verifyValue = (\n      value: number | string | undefined,\n      update?: boolean\n    ): number | undefined => {\n      const { max, min, step, precision, stepStrictly } = props\n      let newVal = Number(value)\n      if (value === null) {\n        newVal = Number.NaN\n      }\n      if (!Number.isNaN(newVal)) {\n        if (stepStrictly) {\n          newVal = Math.round(newVal / step) * step\n        }\n        if (!isUndefined(precision)) {\n          newVal = toPrecision(newVal, precision)\n        }\n        if (newVal > max || newVal < min) {\n          newVal = newVal > max ? max : min\n          update && emit('update:modelValue', newVal)\n        }\n      }\n      return newVal\n    }\n    const setCurrentValue = (value: number | string | undefined) => {\n      const oldVal = data.currentValue\n      let newVal = verifyValue(value)\n      if (oldVal === newVal) return\n      if (Number.isNaN(newVal)) {\n        newVal = undefined\n      }\n      data.userInput = null\n      emit('update:modelValue', newVal)\n      emit('input', newVal)\n      emit('change', newVal, oldVal)\n      formItem?.validate?.('change').catch((err) => debugWarn(err))\n      data.currentValue = newVal\n    }\n    const handleInput = (value: string) => {\n      return (data.userInput = value)\n    }\n    const handleInputChange = (value: string) => {\n      const newVal = value !== '' ? Number(value) : ''\n      if ((isNumber(newVal) && !Number.isNaN(newVal)) || value === '') {\n        setCurrentValue(newVal)\n      }\n      data.userInput = null\n    }\n\n    const focus = () => {\n      input.value?.focus?.()\n    }\n\n    const blur = () => {\n      input.value?.blur?.()\n    }\n\n    const handleFocus = (event: MouseEvent | FocusEvent) => {\n      emit('focus', event)\n    }\n\n    const handleBlur = (event: MouseEvent | FocusEvent) => {\n      emit('blur', event)\n      formItem?.validate?.('blur').catch((err) => debugWarn(err))\n    }\n\n    watch(\n      () => props.modelValue,\n      (value) => {\n        const newVal = verifyValue(value, true)\n        data.currentValue = newVal\n        data.userInput = null\n      },\n      { immediate: true }\n    )\n    onMounted(() => {\n      const innerInput = input.value?.input as HTMLInputElement\n      innerInput.setAttribute('role', 'spinbutton')\n      innerInput.setAttribute('aria-valuemax', String(props.max))\n      innerInput.setAttribute('aria-valuemin', String(props.min))\n      innerInput.setAttribute('aria-valuenow', String(data.currentValue))\n      innerInput.setAttribute(\n        'aria-disabled',\n        String(inputNumberDisabled.value)\n      )\n      if (!isNumber(props.modelValue)) {\n        let val: number | undefined = Number(props.modelValue)\n        if (Number.isNaN(val)) {\n          val = undefined\n        }\n        emit('update:modelValue', val)\n      }\n    })\n    onUpdated(() => {\n      const innerInput = input.value?.input\n      innerInput?.setAttribute('aria-valuenow', data.currentValue)\n    })\n    return {\n      input,\n      displayValue,\n      handleInput,\n      handleInputChange,\n      controlsAtRight,\n      decrease,\n      increase,\n      inputNumberSize,\n      inputNumberDisabled,\n      maxDisabled,\n      minDisabled,\n      focus,\n      blur,\n      handleFocus,\n      handleBlur,\n      ns,\n    }\n  },\n})\n</script>\n"]},"metadata":{},"sourceType":"module"}