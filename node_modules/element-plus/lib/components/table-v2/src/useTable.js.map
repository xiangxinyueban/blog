{"version":3,"file":"useTable.js","sources":["../../../../../../packages/components/table-v2/src/useTable.ts"],"sourcesContent":["import { computed, unref } from 'vue'\n\nimport type { CSSProperties, Ref } from 'vue'\nimport type { Column, Columns } from './types'\n\nconst getColumnStyle = (\n  column: Column<any>,\n  fixedColumn: boolean\n): CSSProperties => {\n  const style = {\n    ...(column.style ?? {}),\n    width: column.width,\n  }\n\n  if (!fixedColumn) {\n    if (column.maxWidth) style.maxWidth = column.maxWidth\n    if (column.minWidth) style.maxWidth = column.minWidth\n  }\n\n  return style\n}\n\nfunction useColumns(columns: Ref<Columns<any>>, fixed: Ref<boolean>) {\n  let mappedColumnsCopy: Columns<any> = []\n\n  const mappedColumns = computed(() => {\n    const _columns = unref(columns)\n    const ret = _columns.map((column) => {\n      if (!column.resizable) return column\n\n      let { width } = column\n      if (column.resizable) {\n        const idx = _columns.findIndex(\n          (predicated) => column.key === predicated.key\n        )\n        if (idx >= 0 && _columns[idx].width === column.width) {\n          width = mappedColumnsCopy[idx].width\n        }\n      }\n      return {\n        ...column,\n        width,\n      }\n    })\n\n    mappedColumnsCopy = ret\n    return ret\n  })\n\n  const visibleColumns = computed(() => {\n    return unref(mappedColumns).filter((column) => !column.hidden)\n  })\n\n  const fixedColumnsOnLeft = computed(() =>\n    unref(visibleColumns).filter(\n      (column) => column.fixed === 'left' || column.fixed === true\n    )\n  )\n\n  const fixedColumnOnRight = computed(() =>\n    unref(visibleColumns).filter((column) => column.fixed === 'right')\n  )\n\n  const normalColumns = computed(() =>\n    unref(visibleColumns).filter((column) => !column.fixed)\n  )\n\n  const mainColumns = computed(() => {\n    const ret: Columns<any> = []\n\n    unref(fixedColumnsOnLeft).forEach((column) => {\n      ret.push({\n        ...column,\n        isPlaceholder: true,\n      })\n    })\n\n    unref(normalColumns).forEach((column) => {\n      ret.push(column)\n    })\n\n    unref(fixedColumnOnRight).forEach((column) => {\n      ret.push({\n        ...column,\n        isPlaceholder: true,\n      })\n    })\n\n    return ret\n  })\n\n  const columnsStyle = computed(() => {\n    const columns = unref(mappedColumns)\n\n    return columns.reduce<Record<Column<any>['key'], CSSProperties>>(\n      (style, column) => {\n        style[column.key] = getColumnStyle(column, unref(fixed))\n        return style\n      },\n      {}\n    )\n  })\n\n  return {\n    columns: mappedColumns,\n    columnsStyle,\n    fixedColumnsOnLeft,\n    fixedColumnOnRight,\n    mainColumns,\n    normalColumns,\n    visibleColumns,\n  }\n}\n\nfunction useTable() {\n  // to be filled\n}\n\nexport { useColumns, useTable }\n"],"names":["computed","unref"],"mappings":"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"}